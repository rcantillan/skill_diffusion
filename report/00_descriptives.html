<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Roberto Cantillan">
<meta name="dcterms.date" content="2025-04-16">

<title>Análisis Descriptivo de Redes de Habilidades y Ocupaciones Basadas en Nivel Requerido (2005-2024)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="00_descriptives_files/libs/clipboard/clipboard.min.js"></script>
<script src="00_descriptives_files/libs/quarto-html/quarto.js"></script>
<script src="00_descriptives_files/libs/quarto-html/popper.min.js"></script>
<script src="00_descriptives_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="00_descriptives_files/libs/quarto-html/anchor.min.js"></script>
<link href="00_descriptives_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="00_descriptives_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="00_descriptives_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="00_descriptives_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="00_descriptives_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción"><span class="header-section-number">1</span> Introducción</a>
  <ul class="collapse">
  <li><a href="#relevancia-y-justificación" id="toc-relevancia-y-justificación" class="nav-link" data-scroll-target="#relevancia-y-justificación"><span class="header-section-number">1.1</span> Relevancia y Justificación</a></li>
  <li><a href="#objetivos-de-este-análisis" id="toc-objetivos-de-este-análisis" class="nav-link" data-scroll-target="#objetivos-de-este-análisis"><span class="header-section-number">1.2</span> Objetivos de este Análisis</a></li>
  </ul></li>
  <li><a href="#metodología-construcción-de-redes-basada-en-nivel" id="toc-metodología-construcción-de-redes-basada-en-nivel" class="nav-link" data-scroll-target="#metodología-construcción-de-redes-basada-en-nivel"><span class="header-section-number">2</span> Metodología: Construcción de Redes (Basada en Nivel)</a>
  <ul class="collapse">
  <li><a href="#preprocesamiento-y-cálculo-de-rca-basado-en-nivel" id="toc-preprocesamiento-y-cálculo-de-rca-basado-en-nivel" class="nav-link" data-scroll-target="#preprocesamiento-y-cálculo-de-rca-basado-en-nivel"><span class="header-section-number">2.1</span> 1. Preprocesamiento y Cálculo de RCA (Basado en Nivel)</a></li>
  <li><a href="#red-de-habilidades-skillscape---nivel" id="toc-red-de-habilidades-skillscape---nivel" class="nav-link" data-scroll-target="#red-de-habilidades-skillscape---nivel"><span class="header-section-number">2.2</span> 2. Red de Habilidades (Skillscape - Nivel)</a></li>
  <li><a href="#red-de-ocupaciones-nivel" id="toc-red-de-ocupaciones-nivel" class="nav-link" data-scroll-target="#red-de-ocupaciones-nivel"><span class="header-section-number">2.3</span> 3. Red de Ocupaciones (Nivel)</a></li>
  </ul></li>
  <li><a href="#análisis-descriptivo-de-las-redes-por-período" id="toc-análisis-descriptivo-de-las-redes-por-período" class="nav-link" data-scroll-target="#análisis-descriptivo-de-las-redes-por-período"><span class="header-section-number">3</span> Análisis Descriptivo de las Redes por Período</a>
  <ul class="collapse">
  <li><a href="#definición-de-períodos-y-rutas-basadas-en-nivel" id="toc-definición-de-períodos-y-rutas-basadas-en-nivel" class="nav-link" data-scroll-target="#definición-de-períodos-y-rutas-basadas-en-nivel"><span class="header-section-number">3.1</span> Definición de Períodos y Rutas (Basadas en Nivel)</a></li>
  <li><a href="#procesamiento-y-análisis-por-período-basado-en-nivel" id="toc-procesamiento-y-análisis-por-período-basado-en-nivel" class="nav-link" data-scroll-target="#procesamiento-y-análisis-por-período-basado-en-nivel"><span class="header-section-number">3.2</span> Procesamiento y Análisis por Período (Basado en Nivel)</a></li>
  <li><a href="#resumen-de-estadísticas-de-red-por-período-basado-en-nivel" id="toc-resumen-de-estadísticas-de-red-por-período-basado-en-nivel" class="nav-link" data-scroll-target="#resumen-de-estadísticas-de-red-por-período-basado-en-nivel"><span class="header-section-number">3.3</span> Resumen de Estadísticas de Red por Período (Basado en Nivel)</a></li>
  <li><a href="#evolución-temporal-de-métricas-de-red" id="toc-evolución-temporal-de-métricas-de-red" class="nav-link" data-scroll-target="#evolución-temporal-de-métricas-de-red"><span class="header-section-number">3.4</span> Evolución Temporal de Métricas de Red</a></li>
  <li><a href="#backbone" id="toc-backbone" class="nav-link" data-scroll-target="#backbone"><span class="header-section-number">3.5</span> Backbone</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Análisis Descriptivo de Redes de Habilidades y Ocupaciones Basadas en Nivel Requerido (2005-2024)</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Roberto Cantillan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 16, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introducción" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introducción</h1>
<section id="relevancia-y-justificación" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="relevancia-y-justificación"><span class="header-section-number">1.1</span> Relevancia y Justificación</h2>
<p>La persistencia de la segregación ocupacional, a pesar de la disminución de barreras formales, presenta un enigma fundamental en la investigación sobre estratificación <span class="citation" data-cites="blau2017">[@blau2017]</span>. Comprender los mecanismos subyacentes que reproducen estas desigualdades es crucial. Trabajos recientes han revelado características estructurales clave del mercado laboral que informan este problema desde dos ángulos complementarios:</p>
<ul>
<li><p>Polarización Horizontal: <span class="citation" data-cites="alabdulkareem2018">[@alabdulkareem2018]</span> demostraron, utilizando redes de complementariedad de habilidades (basadas en Importancia), que el espacio de habilidades está marcadamente polarizado en dos grandes clústeres: uno sociocognitivo y otro sensorio-físico[source: 5, 94, 106].</p></li>
<li><p>Jerarquía Anidada: <span class="citation" data-cites="hosseinioun2025">[@hosseinioun2025]</span> revelaron una estructura jerárquica y anidada de dependencias direccionales entre habilidades (basadas principalmente en Nivel), inferida a partir de probabilidades condicionales asimétricas[source: 293, 294, 380]. Esta estructura sugiere que la adquisición de habilidades especializadas a menudo depende de habilidades fundamentales previas, creando vías estructuradas para el desarrollo del capital humano[source: 295, 304, 370].</p></li>
</ul>
<p>Ambos hallazgos describen la arquitectura estática dentro de la cual ocurren la movilidad y la segregación. Acá proponemos un marco teórico de “Difusión Estructuralmente Condicionada” que busca conectar estas estructuras con los procesos dinámicos a través de los cuales se reproducen, analizando cómo la difusión de habilidades es moldeada por estas estructuras de polarización y dependencia.</p>
</section>
<section id="objetivos-de-este-análisis" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="objetivos-de-este-análisis"><span class="header-section-number">1.2</span> Objetivos de este Análisis</h2>
<p>Este documento representa un primer paso empírico en esa agenda. Se enfoca en construir y describir las características básicas de las redes basadas en la complementariedad de habilidades y la similitud ocupacional, adaptando la metodología de <span class="citation" data-cites="alabdulkareem2018">[@alabdulkareem2018]</span> para utilizar el Nivel (Level) requerido de las habilidades como métrica base. La elección de “Level” se alinea con el enfoque de <span class="citation" data-cites="hosseinioun2025">[@hosseinioun2025]</span> y la naturaleza secuencial del desarrollo de habilidades, central para el análisis de dependencias y difusión[source: 343]. Específicamente, se construyen y analizan:</p>
<ul>
<li><p>Red de Habilidades (Skillscape - Nivel): Nodos = habilidades, Enlaces = complementariedad <span class="math inline">\(q(s,s')\)</span> calculada a partir de RCA basada en Nivel.</p></li>
<li><p>Red de Ocupaciones (Nivel): Nodos = ocupaciones, Enlaces = similitud <span class="math inline">\(q(j,j')\)</span> basada en habilidades (Nivel) compartidas efectivamente.</p></li>
</ul>
<p>Se examinará cómo las propiedades estructurales básicas de estas redes (tamaño, densidad, conectividad, clustering) han evolucionado a lo largo de los períodos 2005-2009, 2010-2014, 2015-2019 y 2020-2024, utilizando datos de O*NET.</p>
</section>
</section>
<section id="metodología-construcción-de-redes-basada-en-nivel" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Metodología: Construcción de Redes (Basada en Nivel)</h1>
<p>Los scripts implementan los siguientes pasos.</p>
<section id="preprocesamiento-y-cálculo-de-rca-basado-en-nivel" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="preprocesamiento-y-cálculo-de-rca-basado-en-nivel"><span class="header-section-number">2.1</span> 1. Preprocesamiento y Cálculo de RCA (Basado en Nivel)</h2>
<p>Datos: Se combinan datos de O*NET (Skills, Abilities, Knowledge, Work Activities). Los datos de Work Styles se excluyen ya que solo tienen escala de Importancia.</p>
<ul>
<li><p>Períodos: Se agrupan en bloques de 5 años, usando la observación más reciente por ocupación-habilidad-escala.</p></li>
<li><p>Métrica Base: Se utiliza el Nivel (Scale.ID == “LV”) requerido de cada habilidad <span class="math inline">\(s\)</span> en la ocupación <span class="math inline">\(j\)</span>, denotado como <span class="math inline">\(Level(j, s)\)</span>.</p></li>
<li><p>RCA: Se calcula la Ventaja Comparativa Revelada (RCA) para cada par <span class="math inline">\((j, s)\)</span> en cada período usando los valores de Nivel: <span class="math display">\[ RCA_{Level}(j, s) = \frac{Level(j, s) / \sum_{s'} Level(j, s')}{\sum_{j'} Level(j', s) / \sum_{j', s'} Level(j', s')} \]</span></p></li>
<li><p>Uso Efectivo: Se define el uso efectivo <span class="math inline">\(e_{Level}(j, s) = 1\)</span> si <span class="math inline">\(RCA_{Level}(j, s) &gt; 1\)</span>, y <span class="math inline">\(0\)</span> si no.</p></li>
</ul>
</section>
<section id="red-de-habilidades-skillscape---nivel" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="red-de-habilidades-skillscape---nivel"><span class="header-section-number">2.2</span> 2. Red de Habilidades (Skillscape - Nivel)</h2>
<p>Se construye una red no dirigida donde los nodos son habilidades (<span class="math inline">\(s, s'\)</span>) y el peso del enlace <span class="math inline">\(q(s, s')\)</span> representa su complementariedad, calculada usando el indicador de uso efectivo basado en Nivel (<span class="math inline">\(e_{Level}\)</span>):</p>
<p><span class="math display">\[
q(s, s') = \frac{\sum_{j} e_{Level}(j, s) \cdot e_{Level}(j, s')}{\max\left(\sum_{j} e_{Level}(j, s), \sum_{j} e_{Level}(j, s')\right)}
\]</span></p>
<p>Se utiliza el archivo skill_pairs_level.csv generado por el script</p>
</section>
<section id="red-de-ocupaciones-nivel" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="red-de-ocupaciones-nivel"><span class="header-section-number">2.3</span> 3. Red de Ocupaciones (Nivel)</h2>
<p>Se construye una red no dirigida donde los nodos son ocupaciones (<span class="math inline">\(j, j'\)</span>) y el peso del enlace <span class="math inline">\(q(j, j')\)</span> representa la similitud de sus perfiles de habilidades (Nivel) efectivamente utilizadas:</p>
<p><span class="math display">\[
q(j, j') = \frac{\sum_{s} e_{Level}(j, s) \cdot e_{Level}(j', s)}{\max\left(\sum_{s} e_{Level}(j, s), \sum_{s} e_{Level}(j', s)\right)}
\]</span></p>
<p>Se utiliza el archivo occupation_pairs_level.csv.</p>
</section>
</section>
<section id="análisis-descriptivo-de-las-redes-por-período" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Análisis Descriptivo de las Redes por Período</h1>
<section id="definición-de-períodos-y-rutas-basadas-en-nivel" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="definición-de-períodos-y-rutas-basadas-en-nivel"><span class="header-section-number">3.1</span> Definición de Períodos y Rutas (Basadas en Nivel)</h2>
<div class="cell">
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir los períodos de análisis</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>periods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"2005-2009"</span>, <span class="st">"2010-2014"</span>, <span class="st">"2015-2019"</span>, <span class="st">"2020-2024"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rutas base a carpetas con resultados basados en LEVEL</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>skill_network_base_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"skillscape_level_method"</span>) </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>occupation_network_base_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"occupation_network_level_method"</span>) </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar datos de títulos de ocupaciones usando el nombre correcto</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>occupation_titles_df <span class="ot">&lt;-</span> <span class="fu">data.table</span>() </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatch</span>({</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    occ_data_path <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"Occupation Data.txt"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">file.exists</span>(occ_data_path)) {</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Leer el archivo COMPLETO primero (asumiendo separador TAB)</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        occ_data_full <span class="ot">&lt;-</span> <span class="fu">fread</span>(occ_data_path, <span class="at">encoding =</span> <span class="st">"UTF-8"</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>) </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verificar usando el nombre REAL de la columna</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        expected_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"O*NET-SOC Code"</span>, <span class="st">"Title"</span>) <span class="co"># Nombre exacto!</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">all</span>(expected_cols <span class="sc">%in%</span> <span class="fu">names</span>(occ_data_full))) {</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Seleccionar y renombrar usando el nombre REAL (con backticks)</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>            occupation_titles_df <span class="ot">&lt;-</span> occ_data_full[, .(</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">occ_id =</span> <span class="st">`</span><span class="at">O*NET-SOC Code</span><span class="st">`</span>, <span class="co"># Backticks necesarios!</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">occ_title =</span> Title</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>            )]</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Filtrar y procesar...</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>            occupation_titles_df <span class="ot">&lt;-</span> occupation_titles_df[<span class="sc">!</span><span class="fu">is.na</span>(occ_id) <span class="sc">&amp;</span> occ_id <span class="sc">!=</span> <span class="st">""</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(occ_title) <span class="sc">&amp;</span> occ_title <span class="sc">!=</span> <span class="st">""</span>]</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>            occupation_titles_df <span class="ot">&lt;-</span> occupation_titles_df[, .SD[<span class="dv">1</span>], by <span class="ot">=</span> occ_id] </span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">setkey</span>(occupation_titles_df, occ_id) </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cat</span>(<span class="st">"Títulos de ocupaciones cargados y procesados correctamente.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>             <span class="fu">cat</span>(<span class="st">"Error: Columnas 'O*NET-SOC Code' o 'Title' no encontradas en Occupation Data.txt. Columnas presentes:"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(occ_data_full), <span class="at">collapse=</span><span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>             occupation_titles_df <span class="ot">&lt;-</span> <span class="fu">data.table</span>() </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"Archivo Occupation Data.txt no encontrado, se usarán IDs para ocupaciones.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>}, <span class="at">error =</span> <span class="cf">function</span>(e){ </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Error procesando títulos de ocupaciones:"</span>, e<span class="sc">$</span>message, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    occupation_titles_df <span class="ot">&lt;-</span> <span class="fu">data.table</span>() </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Títulos de ocupaciones cargados y procesados correctamente.</code></pre>
</div>
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Definición de Funciones Auxiliares ---</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para leer CSV </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>read_exported_csv <span class="ot">&lt;-</span> <span class="cf">function</span>(file_path) {</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file_path)) { <span class="fu">warning</span>(<span class="st">"Archivo no encontrado: "</span>, file_path); <span class="fu">return</span>(<span class="cn">NULL</span>) }</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tryCatch</span>({</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>     data <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(file_path, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">";"</span>, <span class="at">dec =</span> <span class="st">"."</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="at">quote =</span> <span class="st">"</span><span class="sc">\"</span><span class="st">"</span>, <span class="at">encoding =</span> <span class="st">"UTF-8"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> (<span class="st">"weight"</span> <span class="sc">%in%</span> <span class="fu">names</span>(data) <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.numeric</span>(data<span class="sc">$</span>weight)) data[, weight <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(weight)]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> (<span class="st">"count"</span> <span class="sc">%in%</span> <span class="fu">names</span>(data) <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.integer</span>(data<span class="sc">$</span>count)) data[, count <span class="sc">:</span><span class="er">=</span> <span class="fu">as.integer</span>(count)]</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> (<span class="st">"max_count"</span> <span class="sc">%in%</span> <span class="fu">names</span>(data) <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.integer</span>(data<span class="sc">$</span>max_count)) data[, max_count <span class="sc">:</span><span class="er">=</span> <span class="fu">as.integer</span>(max_count)]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">return</span>(data)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>   }, <span class="at">error =</span> <span class="cf">function</span>(e) { <span class="fu">warning</span>(<span class="st">"Error leyendo archivo "</span>, file_path, <span class="st">": "</span>, e<span class="sc">$</span>message); <span class="fu">return</span>(<span class="cn">NULL</span>) })</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para calcular estadísticas extendidas</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>calculate_network_stats_extended <span class="ot">&lt;-</span> <span class="cf">function</span>(g, <span class="at">community_algo =</span> cluster_louvain) {</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>   stats_base <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">num_nodes =</span> <span class="dv">0</span>, <span class="at">num_edges =</span> <span class="dv">0</span>, <span class="at">density =</span> <span class="cn">NA</span>, <span class="at">avg_path_length =</span> <span class="cn">NA</span>, <span class="at">transitivity =</span> <span class="cn">NA</span>, <span class="at">components =</span> <span class="cn">NA</span>, <span class="at">giant_component_prop =</span> <span class="cn">NA</span>, <span class="at">avg_degree =</span> <span class="cn">NA</span>, <span class="at">avg_weighted_degree =</span> <span class="cn">NA</span>, <span class="at">modularity =</span> <span class="cn">NA</span>, <span class="at">num_communities =</span> <span class="cn">NA</span>, <span class="at">degree_centralization =</span> <span class="cn">NA</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.igraph</span>(g) <span class="sc">||</span> <span class="fu">vcount</span>(g) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(stats_base)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>   stats_base<span class="sc">$</span>num_nodes <span class="ot">=</span> igraph<span class="sc">::</span><span class="fu">vcount</span>(g); stats_base<span class="sc">$</span>num_edges <span class="ot">=</span> igraph<span class="sc">::</span><span class="fu">ecount</span>(g)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>   stats_base<span class="sc">$</span>density <span class="ot">=</span> igraph<span class="sc">::</span><span class="fu">edge_density</span>(g, <span class="at">loops =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>   is_connected <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">is_connected</span>(g, <span class="at">mode =</span> <span class="st">"weak"</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>   components_info <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">components</span>(g, <span class="at">mode =</span> <span class="st">"weak"</span>); stats_base<span class="sc">$</span>components <span class="ot">&lt;-</span> components_info<span class="sc">$</span>no</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(stats_base<span class="sc">$</span>components) <span class="sc">&amp;&amp;</span> stats_base<span class="sc">$</span>components <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> stats_base<span class="sc">$</span>num_nodes <span class="sc">&gt;</span> <span class="dv">0</span>) { </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>       giant_component_nodes <span class="ot">&lt;-</span> <span class="fu">max</span>(components_info<span class="sc">$</span>csize, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span>(<span class="fu">is.finite</span>(giant_component_nodes)) { </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>           stats_base<span class="sc">$</span>giant_component_prop <span class="ot">&lt;-</span> giant_component_nodes <span class="sc">/</span> stats_base<span class="sc">$</span>num_nodes </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>       } <span class="cf">else</span> { stats_base<span class="sc">$</span>giant_component_prop <span class="ot">&lt;-</span> <span class="cn">NA</span> }</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>   } <span class="cf">else</span> { stats_base<span class="sc">$</span>giant_component_prop <span class="ot">&lt;-</span> <span class="cn">NA</span> }</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span> (stats_base<span class="sc">$</span>num_nodes <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span> (is_connected) { stats_base<span class="sc">$</span>avg_path_length <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(igraph<span class="sc">::</span><span class="fu">mean_distance</span>(g, <span class="at">directed =</span> <span class="cn">FALSE</span>), <span class="at">error=</span><span class="cf">function</span>(e) <span class="cn">NA</span>) </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>       } <span class="cf">else</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(stats_base<span class="sc">$</span>giant_component_prop) <span class="sc">&amp;&amp;</span> stats_base<span class="sc">$</span>giant_component_prop <span class="sc">&gt;</span> <span class="fl">0.9</span>) {</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>           giant_nodes_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(components_info<span class="sc">$</span>membership <span class="sc">==</span> <span class="fu">which.max</span>(components_info<span class="sc">$</span>csize))</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>           <span class="cf">if</span>(<span class="fu">length</span>(giant_nodes_idx)<span class="sc">&gt;</span><span class="dv">1</span>){ </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>               giant_graph <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">induced_subgraph</span>(g, giant_nodes_idx)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>               <span class="cf">if</span>(<span class="fu">vcount</span>(giant_graph) <span class="sc">&gt;</span> <span class="dv">1</span>) { stats_base<span class="sc">$</span>avg_path_length <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(igraph<span class="sc">::</span><span class="fu">mean_distance</span>(giant_graph, <span class="at">directed =</span> <span class="cn">FALSE</span>), <span class="at">error=</span><span class="cf">function</span>(e) <span class="cn">NA</span>) } </span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>           }</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>       } </span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>       stats_base<span class="sc">$</span>transitivity <span class="ot">=</span> <span class="fu">tryCatch</span>(igraph<span class="sc">::</span><span class="fu">transitivity</span>(g, <span class="at">type =</span> <span class="st">"global"</span>), <span class="at">error=</span><span class="cf">function</span>(e) <span class="cn">NA</span>)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>       stats_base<span class="sc">$</span>avg_degree <span class="ot">=</span> <span class="fu">mean</span>(igraph<span class="sc">::</span><span class="fu">degree</span>(g), <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>       stats_base<span class="sc">$</span>degree_centralization <span class="ot">=</span> <span class="cf">if</span>(stats_base<span class="sc">$</span>num_nodes <span class="sc">&gt;</span> <span class="dv">2</span>) { <span class="fu">tryCatch</span>(igraph<span class="sc">::</span><span class="fu">centr_degree</span>(g, <span class="at">normalized =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>centralization, <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NA</span>) } <span class="cf">else</span> { <span class="cn">NA</span> }</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>   has_weights <span class="ot">&lt;-</span> <span class="st">"weight"</span> <span class="sc">%in%</span> igraph<span class="sc">::</span><span class="fu">edge_attr_names</span>(g)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>   edge_weights <span class="ot">&lt;-</span> <span class="cf">if</span>(has_weights) <span class="fu">E</span>(g)<span class="sc">$</span>weight <span class="cf">else</span> <span class="cn">NULL</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Asegurar que edge_weights no contenga NAs o valores no positivos si se usan para cálculos</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span>(has_weights) edge_weights <span class="ot">&lt;-</span> edge_weights[<span class="fu">is.finite</span>(edge_weights) <span class="sc">&amp;</span> edge_weights <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="cf">else</span> edge_weights <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(edge_weights) <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(edge_weights) <span class="sc">==</span> <span class="fu">ecount</span>(g)) { <span class="co"># Verificar si aún tenemos pesos válidos</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>        stats_base<span class="sc">$</span>avg_weighted_degree <span class="ot">&lt;-</span> <span class="fu">mean</span>(igraph<span class="sc">::</span><span class="fu">strength</span>(g, <span class="at">weights =</span> <span class="fu">E</span>(g)<span class="sc">$</span>weight), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="co"># Strength es robusto</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>   } <span class="cf">else</span> {</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>        stats_base<span class="sc">$</span>avg_weighted_degree <span class="ot">&lt;-</span> stats_base<span class="sc">$</span>avg_degree <span class="co"># Fallback a grado no ponderado si hay problema con pesos</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>        has_weights <span class="ot">&lt;-</span> <span class="cn">FALSE</span> <span class="co"># Indicar que no se usarán pesos para modularidad</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span> (stats_base<span class="sc">$</span>num_edges <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>       <span class="co"># Pasar pesos a Louvain solo si son válidos</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>       current_weights <span class="ot">&lt;-</span> <span class="cf">if</span>(has_weights) <span class="fu">E</span>(g)<span class="sc">$</span>weight <span class="cf">else</span> <span class="cn">NULL</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>       comm <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({ <span class="fu">community_algo</span>(g, <span class="at">weights =</span> current_weights) }, <span class="at">error =</span> <span class="cf">function</span>(e) { <span class="fu">warning</span>(<span class="st">"Error en community_algo: "</span>, e<span class="sc">$</span>message); <span class="cn">NULL</span>}) </span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(comm) <span class="sc">&amp;&amp;</span> <span class="fu">inherits</span>(comm, <span class="st">"communities"</span>)) { </span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>           <span class="co"># Calcular modularidad usando los mismos pesos usados por el algoritmo</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>           stats_base<span class="sc">$</span>modularity <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({ igraph<span class="sc">::</span><span class="fu">modularity</span>(comm) }, <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NA</span>)</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>           stats_base<span class="sc">$</span>num_communities <span class="ot">&lt;-</span> <span class="fu">length</span>(comm)</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>       } <span class="cf">else</span> { stats_base<span class="sc">$</span>modularity <span class="ot">&lt;-</span> <span class="cn">NA</span>; stats_base<span class="sc">$</span>num_communities <span class="ot">&lt;-</span> <span class="cn">NA</span> }</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>   } <span class="cf">else</span> { stats_base<span class="sc">$</span>modularity <span class="ot">&lt;-</span> <span class="cn">NA</span>; stats_base<span class="sc">$</span>num_communities <span class="ot">&lt;-</span> stats_base<span class="sc">$</span>num_nodes }</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(stats_base)</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper para formatear tablas de centralidad (Skills - CORREGIDO)</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>format_cent <span class="ot">&lt;-</span> <span class="cf">function</span>(cent_vector, name_map) {</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>    default_empty <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">rank=</span><span class="fu">integer</span>(), <span class="at">id=</span><span class="fu">character</span>(), <span class="at">name=</span><span class="fu">character</span>(), <span class="at">value=</span><span class="fu">numeric</span>())</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(cent_vector) <span class="sc">||</span> <span class="fu">length</span>(cent_vector) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(default_empty)</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>    dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">id =</span> <span class="fu">names</span>(cent_vector), <span class="at">value =</span> cent_vector, <span class="at">key =</span> <span class="st">"id"</span>)</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">inherits</span>(name_map, <span class="st">"data.table"</span>) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(name_map) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"name"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(name_map))){</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>        dt_join_result <span class="ot">&lt;-</span> name_map[dt, on <span class="ot">=</span> .(id), nomatch<span class="ot">=</span><span class="dv">0</span>] </span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">nrow</span>(dt_join_result) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"name"</span>, <span class="st">"value"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(dt_join_result))) {</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>             dt_join <span class="ot">&lt;-</span> dt_join_result[, .(id, name, value)][<span class="fu">order</span>(<span class="sc">-</span>value)] <span class="co"># Usa 'name' directamente</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> { dt_join <span class="ot">&lt;-</span> <span class="fu">data.table</span>() }</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>        missing_ids <span class="ot">&lt;-</span> dt[<span class="sc">!</span>id <span class="sc">%in%</span> dt_join<span class="sc">$</span>id]</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">nrow</span>(missing_ids) <span class="sc">&gt;</span> <span class="dv">0</span>) { missing_ids[, name <span class="sc">:</span><span class="er">=</span> id]; dt_join <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dt_join, missing_ids[,.(id, name, value)])[<span class="fu">order</span>(<span class="sc">-</span>value)] }</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> { dt_join <span class="ot">&lt;-</span> dt[, name <span class="sc">:</span><span class="er">=</span> id][<span class="fu">order</span>(<span class="sc">-</span>value)] }</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(dt_join) <span class="sc">&gt;</span> <span class="dv">0</span>) dt_join[, rank <span class="sc">:</span><span class="er">=</span> <span class="dv">1</span><span class="sc">:</span>.N] <span class="cf">else</span> dt_join <span class="ot">&lt;-</span> default_empty</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(dt_join)</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper para formatear tablas de centralidad (Occupations - revisado)</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>format_cent_occ <span class="ot">&lt;-</span> <span class="cf">function</span>(cent_vector, title_map) {</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>     default_empty <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">rank=</span><span class="fu">integer</span>(), <span class="at">id=</span><span class="fu">character</span>(), <span class="at">name=</span><span class="fu">character</span>(), <span class="at">value=</span><span class="fu">numeric</span>())</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span>(<span class="fu">is.null</span>(cent_vector) <span class="sc">||</span> <span class="fu">length</span>(cent_vector) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(default_empty)</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>     dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">id =</span> <span class="fu">names</span>(cent_vector), <span class="at">value =</span> cent_vector, <span class="at">key =</span> <span class="st">"id"</span>)</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> (<span class="fu">inherits</span>(title_map, <span class="st">"data.table"</span>) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(title_map) <span class="sc">&gt;</span> <span class="dv">0</span>) { </span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(<span class="sc">!</span><span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"occ_id"</span>, <span class="st">"occ_title"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(title_map))) {</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>             <span class="fu">warning</span>(<span class="st">"Cols 'occ_id', 'occ_title' no encontradas. Intentando usar las 2 primeras."</span>)</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>             <span class="cf">if</span>(<span class="fu">ncol</span>(title_map)<span class="sc">&gt;=</span><span class="dv">2</span>) <span class="fu">setnames</span>(title_map, <span class="fu">names</span>(title_map)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="fu">c</span>(<span class="st">"occ_id"</span>, <span class="st">"occ_title"</span>)) <span class="cf">else</span> title_map <span class="ot">&lt;-</span> <span class="fu">data.table</span>() </span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(<span class="fu">nrow</span>(title_map) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>               <span class="fu">setkey</span>(title_map, occ_id)</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>               <span class="co"># Usar left join para no perder ocupaciones sin título</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>               dt_join <span class="ot">&lt;-</span> title_map[dt, on <span class="ot">=</span> .(<span class="at">occ_id =</span> id)] <span class="co"># Left join por defecto</span></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>               dt_join[<span class="fu">is.na</span>(occ_title), occ_title <span class="sc">:</span><span class="er">=</span> occ_id] <span class="co"># Usar ID si falta título</span></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>               dt_join <span class="ot">&lt;-</span> dt_join[, .(<span class="at">id =</span> occ_id, <span class="at">name =</span> occ_title, value)][<span class="fu">order</span>(<span class="sc">-</span>value)] <span class="co"># Seleccionar y ordenar</span></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> { dt_join <span class="ot">&lt;-</span> dt[, name <span class="sc">:</span><span class="er">=</span> id][<span class="fu">order</span>(<span class="sc">-</span>value)] } <span class="co"># Fallback a IDs si title_map quedó vacío</span></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>     } <span class="cf">else</span> { dt_join <span class="ot">&lt;-</span> dt[, name <span class="sc">:</span><span class="er">=</span> id][<span class="fu">order</span>(<span class="sc">-</span>value)] } </span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span>(<span class="fu">nrow</span>(dt_join) <span class="sc">&gt;</span> <span class="dv">0</span>) dt_join[, rank <span class="sc">:</span><span class="er">=</span> <span class="dv">1</span><span class="sc">:</span>.N] <span class="cf">else</span> dt_join <span class="ot">&lt;-</span> default_empty</span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>     <span class="fu">return</span>(dt_join)</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper para imprimir tablas de centralidad</span></span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>print_centrality_table <span class="ot">&lt;-</span> <span class="cf">function</span>(cent_data, metric_name, node_type, <span class="at">top_n =</span> <span class="dv">20</span>) {</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(cent_data) <span class="sc">||</span> <span class="fu">nrow</span>(cent_data) <span class="sc">==</span> <span class="dv">0</span>) { <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">(No hay datos de centralidad "</span>, metric_name, <span class="st">" para "</span>, node_type, <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)); <span class="fu">return</span>() } </span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">#### Top "</span>, top_n, <span class="st">" "</span>, node_type, <span class="st">" por "</span>, metric_name, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"rank"</span>, <span class="st">"name"</span>, <span class="st">"value"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(cent_data))) {</span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Asegurarse que 'name' no sea NA antes de seleccionar</span></span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>        cent_data[, name <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(<span class="fu">is.na</span>(name), id, name)] <span class="co"># Usar ID si el nombre es NA</span></span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>        top_nodes <span class="ot">&lt;-</span> cent_data <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(value)) <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> top_n) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">value =</span> scales<span class="sc">::</span><span class="fu">scientific</span>(value, <span class="at">digits =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">Rank =</span> rank, <span class="at">Nombre =</span> name, <span class="at">Valor =</span> value)</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(knitr<span class="sc">::</span><span class="fu">kable</span>(top_nodes, <span class="at">format =</span> <span class="st">"markdown"</span>)); <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">"(Error: Faltan columnas esperadas en datos de centralidad)</span><span class="sc">\n</span><span class="st">"</span>) }</span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Almacenar estadísticas y centralidades (inicialización)</span></span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>all_stats_level <span class="ot">&lt;-</span> <span class="fu">list</span>() </span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>all_centralities_level <span class="ot">&lt;-</span> <span class="fu">list</span>() </span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>all_opsahl_degrees <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="procesamiento-y-análisis-por-período-basado-en-nivel" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="procesamiento-y-análisis-por-período-basado-en-nivel"><span class="header-section-number">3.2</span> Procesamiento y Análisis por Período (Basado en Nivel)</h2>
<div class="cell">
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bucle principal </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (period <span class="cf">in</span> periods) {</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">### Análisis Período:"</span>, period, <span class="st">"(Basado en Nivel)</span><span class="sc">\n</span><span class="st">"</span>)) </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- 1. Creación de Grafos ---</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">**1. Creación de Grafos**</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  skill_graph <span class="ot">&lt;-</span> <span class="cn">NULL</span>; occ_graph <span class="ot">&lt;-</span> <span class="cn">NULL</span>; </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  skill_names_map <span class="ot">&lt;-</span> <span class="fu">data.table</span>(); </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  skill_pairs_df <span class="ot">&lt;-</span> <span class="cn">NULL</span>; occ_pairs_df <span class="ot">&lt;-</span> <span class="cn">NULL</span> </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grafo Habilidades </span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  skill_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(skill_network_base_dir, period, <span class="st">"skill_pairs_level.csv"</span>); skill_pairs_df <span class="ot">&lt;-</span> <span class="fu">read_exported_csv</span>(skill_file)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(skill_pairs_df) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(skill_pairs_df) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>       skill_pairs_df[, skill1 <span class="sc">:</span><span class="er">=</span> <span class="fu">trimws</span>(<span class="fu">as.character</span>(skill1))]; skill_pairs_df[, skill2 <span class="sc">:</span><span class="er">=</span> <span class="fu">trimws</span>(<span class="fu">as.character</span>(skill2))]; skill_pairs_df <span class="ot">&lt;-</span> skill_pairs_df[<span class="sc">!</span><span class="fu">is.na</span>(skill1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(skill2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(weight) <span class="sc">&amp;</span> weight <span class="sc">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span> (<span class="fu">nrow</span>(skill_pairs_df) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>           all_skill_nodes <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(skill_pairs_df<span class="sc">$</span>skill1, skill_pairs_df<span class="sc">$</span>skill2))</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>           <span class="cf">if</span>(<span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"name1"</span>, <span class="st">"name2"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(skill_pairs_df))) { skill_names_map <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">rbind</span>(skill_pairs_df[, .(<span class="at">id =</span> skill1, <span class="at">name =</span> name1)], skill_pairs_df[, .(<span class="at">id =</span> skill2, <span class="at">name =</span> name2)])); skill_names_map <span class="ot">&lt;-</span> skill_names_map[<span class="sc">!</span><span class="fu">is.na</span>(id) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(name)]; <span class="fu">setkey</span>(skill_names_map, id) } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">"Advertencia: Columnas name1/name2 no encontradas en skill_pairs.</span><span class="sc">\n</span><span class="st">"</span>)}</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>           skill_graph <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({ <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> skill_pairs_df[, .(skill1, skill2, weight)], <span class="at">directed =</span> <span class="cn">FALSE</span>, <span class="at">vertices =</span> <span class="fu">data.frame</span>(<span class="at">name =</span> all_skill_nodes)) }, <span class="at">error =</span> <span class="cf">function</span>(e) { <span class="fu">warning</span>(<span class="st">"Error grafo hab (Nivel) "</span>, period, <span class="st">": "</span>, e<span class="sc">$</span>message); <span class="cn">NULL</span> })</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>           <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(skill_graph)) { skill_graph <span class="ot">&lt;-</span> <span class="fu">simplify</span>(skill_graph, <span class="at">remove.multiple =</span> <span class="cn">TRUE</span>, <span class="at">remove.loops =</span> <span class="cn">TRUE</span>, <span class="at">edge.attr.comb =</span> <span class="st">"mean"</span>); <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"* Red Hab (Nivel): %d nodos, %d enlaces.</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">vcount</span>(skill_graph), <span class="fu">ecount</span>(skill_graph))) } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">"* No red hab.</span><span class="sc">\n</span><span class="st">"</span>) }</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>       } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">"* No pares hab válidos.</span><span class="sc">\n</span><span class="st">"</span>); skill_pairs_df <span class="ot">&lt;-</span> <span class="cn">NULL</span> } </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">"* No datos pares hab (Nivel).</span><span class="sc">\n</span><span class="st">"</span>) }</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grafo Ocupaciones </span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  occ_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(occupation_network_base_dir, period, <span class="st">"occupation_pairs_level.csv"</span>); occ_pairs_df <span class="ot">&lt;-</span> <span class="fu">read_exported_csv</span>(occ_file)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(occ_pairs_df) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(occ_pairs_df) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>       occ_pairs_df[, occupation1 <span class="sc">:</span><span class="er">=</span> <span class="fu">trimws</span>(<span class="fu">as.character</span>(occupation1))]; occ_pairs_df[, occupation2 <span class="sc">:</span><span class="er">=</span> <span class="fu">trimws</span>(<span class="fu">as.character</span>(occupation2))]; occ_pairs_df <span class="ot">&lt;-</span> occ_pairs_df[<span class="sc">!</span><span class="fu">is.na</span>(occupation1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(occupation2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(weight) <span class="sc">&amp;</span> weight <span class="sc">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span> (<span class="fu">nrow</span>(occ_pairs_df) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>           all_occ_nodes <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(occ_pairs_df<span class="sc">$</span>occupation1, occ_pairs_df<span class="sc">$</span>occupation2))</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>           occ_graph <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({ <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> occ_pairs_df[, .(occupation1, occupation2, weight)], <span class="at">directed =</span> <span class="cn">FALSE</span>, <span class="at">vertices =</span> <span class="fu">data.frame</span>(<span class="at">name =</span> all_occ_nodes)) }, <span class="at">error =</span> <span class="cf">function</span>(e) { <span class="fu">warning</span>(<span class="st">"Error grafo occ (Nivel) "</span>, period, <span class="st">": "</span>, e<span class="sc">$</span>message); <span class="cn">NULL</span> })</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>           <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(occ_graph)) { occ_graph <span class="ot">&lt;-</span> <span class="fu">simplify</span>(occ_graph, <span class="at">remove.multiple =</span> <span class="cn">TRUE</span>, <span class="at">remove.loops =</span> <span class="cn">TRUE</span>, <span class="at">edge.attr.comb =</span> <span class="st">"mean"</span>); <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"* Red Occ (Nivel): %d nodos, %d enlaces.</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">vcount</span>(occ_graph), <span class="fu">ecount</span>(occ_graph))) } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">"* No red occ.</span><span class="sc">\n</span><span class="st">"</span>) }</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>       } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">"* No pares occ válidos.</span><span class="sc">\n</span><span class="st">"</span>); occ_pairs_df <span class="ot">&lt;-</span> <span class="cn">NULL</span> } </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>   } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">"* No datos pares occ (Nivel).</span><span class="sc">\n</span><span class="st">"</span>) }</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- 2. Estadísticas Descriptivas y Comunidades ---</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">**2. Estadísticas Descriptivas y Comunidades**</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  current_period_stats <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">skill_network =</span> <span class="fu">calculate_network_stats_extended</span>(skill_graph, cluster_louvain), </span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">occupation_network =</span> <span class="fu">calculate_network_stats_extended</span>(occ_graph, cluster_louvain)</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  all_stats_level[[period]] <span class="ot">&lt;-</span> current_period_stats </span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Impresión de stats</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">* **Red Habilidades:**</span><span class="sc">\n</span><span class="st">"</span>); sk_stats_now <span class="ot">&lt;-</span> current_period_stats<span class="sc">$</span>skill_network; <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"    * Densidad: %.4f; Transitividad: %.4f; Comp.: %s (Gigante: %.3f)</span><span class="sc">\n</span><span class="st">"</span>, sk_stats_now<span class="sc">$</span>density <span class="sc">%||%</span> <span class="cn">NA</span>, sk_stats_now<span class="sc">$</span>transitivity <span class="sc">%||%</span> <span class="cn">NA</span>, sk_stats_now<span class="sc">$</span>components <span class="sc">%||%</span> <span class="st">"NA"</span>, sk_stats_now<span class="sc">$</span>giant_component_prop <span class="sc">%||%</span> <span class="cn">NA</span>)); <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"    * Grado Medio: %.2f (Pond: %.2f); Long. Camino: %.2f</span><span class="sc">\n</span><span class="st">"</span>, sk_stats_now<span class="sc">$</span>avg_degree <span class="sc">%||%</span> <span class="cn">NA</span>, sk_stats_now<span class="sc">$</span>avg_weighted_degree <span class="sc">%||%</span> <span class="cn">NA</span>, sk_stats_now<span class="sc">$</span>avg_path_length <span class="sc">%||%</span> <span class="cn">NA</span>)); <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"    * Modularidad: %.4f; Nº Comunidades: %s; Centr. Grado: %.4f</span><span class="sc">\n</span><span class="st">"</span>, sk_stats_now<span class="sc">$</span>modularity <span class="sc">%||%</span> <span class="cn">NA</span>, sk_stats_now<span class="sc">$</span>num_communities <span class="sc">%||%</span> <span class="st">"NA"</span>, sk_stats_now<span class="sc">$</span>degree_centralization <span class="sc">%||%</span> <span class="cn">NA</span>))</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">* **Red Ocupaciones:**</span><span class="sc">\n</span><span class="st">"</span>); oc_stats_now <span class="ot">&lt;-</span> current_period_stats<span class="sc">$</span>occupation_network; <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"    * Densidad: %.4f; Transitividad: %.4f; Comp.: %s (Gigante: %.3f)</span><span class="sc">\n</span><span class="st">"</span>, oc_stats_now<span class="sc">$</span>density <span class="sc">%||%</span> <span class="cn">NA</span>, oc_stats_now<span class="sc">$</span>transitivity <span class="sc">%||%</span> <span class="cn">NA</span>, oc_stats_now<span class="sc">$</span>components <span class="sc">%||%</span> <span class="st">"NA"</span>, oc_stats_now<span class="sc">$</span>giant_component_prop <span class="sc">%||%</span> <span class="cn">NA</span>)); <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"    * Grado Medio: %.2f (Pond: %.2f); Long. Camino: %.2f</span><span class="sc">\n</span><span class="st">"</span>, oc_stats_now<span class="sc">$</span>avg_degree <span class="sc">%||%</span> <span class="cn">NA</span>, oc_stats_now<span class="sc">$</span>avg_weighted_degree <span class="sc">%||%</span> <span class="cn">NA</span>, oc_stats_now<span class="sc">$</span>avg_path_length <span class="sc">%||%</span> <span class="cn">NA</span>)); <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"    * Modularidad: %.4f; Nº Comunidades: %s; Centr. Grado: %.4f</span><span class="sc">\n</span><span class="st">"</span>, oc_stats_now<span class="sc">$</span>modularity <span class="sc">%||%</span> <span class="cn">NA</span>, oc_stats_now<span class="sc">$</span>num_communities <span class="sc">%||%</span> <span class="st">"NA"</span>, oc_stats_now<span class="sc">$</span>degree_centralization <span class="sc">%||%</span> <span class="cn">NA</span>))</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- 3. Análisis de Centralidad Ponderada ---</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">**3. Análisis de Centralidad (Considerando Pesos)**</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  period_centralities <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>  period_opsahl_degrees <span class="ot">&lt;-</span> <span class="fu">list</span>() </span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- 3.1 Centralidad Red Habilidades ---</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">#### Red de Habilidades:</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(skill_graph) <span class="sc">&amp;&amp;</span> <span class="fu">vcount</span>(skill_graph) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">ecount</span>(skill_graph) <span class="sc">&gt;</span> <span class="dv">0</span>) { </span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Fuerza (Grado Ponderado - igraph)</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>      str_sk <span class="ot">&lt;-</span> <span class="fu">strength</span>(skill_graph, <span class="at">weights =</span> <span class="fu">E</span>(skill_graph)<span class="sc">$</span>weight)</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>      cent_str_sk_df <span class="ot">&lt;-</span> <span class="fu">format_cent</span>(str_sk, skill_names_map)</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print_centrality_table</span>(cent_str_sk_df, <span class="st">"Fuerza (Grado Ponderado igraph)"</span>, <span class="st">"Habilidades"</span>)</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Grado Generalizado Opsahl (tnet)</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>      ops_deg_sk <span class="ot">&lt;-</span> <span class="cn">NULL</span> </span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(skill_pairs_df)) {</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>          tnet_input_sk <span class="ot">&lt;-</span> skill_pairs_df[, .(<span class="at">i =</span> skill1, <span class="at">j =</span> skill2, <span class="at">w =</span> weight)]</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>          ops_deg_sk_raw <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({ <span class="fu">degree_w</span>(tnet_input_sk, <span class="at">measure=</span><span class="fu">c</span>(<span class="st">"alpha"</span>), <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">type=</span><span class="st">"out"</span>) }, <span class="at">error=</span><span class="cf">function</span>(e) <span class="cn">NULL</span>)</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(ops_deg_sk_raw)) { ops_deg_sk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(ops_deg_sk_raw<span class="sc">$</span>output, <span class="fu">as.character</span>(ops_deg_sk_raw<span class="sc">$</span>node)) }</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>       }</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>      cent_ops_deg_sk_df <span class="ot">&lt;-</span> <span class="fu">format_cent</span>(ops_deg_sk, skill_names_map)</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print_centrality_table</span>(cent_ops_deg_sk_df, <span class="st">"Grado Generalizado (Opsahl α=0.5)"</span>, <span class="st">"Habilidades"</span>)</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Betweenness Ponderada (igraph, usando 1/peso)</span></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>      weights_inv_sk <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="fu">E</span>(skill_graph)<span class="sc">$</span>weight <span class="sc">+</span> <span class="fl">1e-9</span>) <span class="co"># Epsilon muy pequeño</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>      weights_inv_sk[<span class="fu">is.infinite</span>(weights_inv_sk)] <span class="ot">&lt;-</span> <span class="fu">max</span>(weights_inv_sk[<span class="fu">is.finite</span>(weights_inv_sk)], <span class="fl">1e9</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co"># Reemplazar Inf con un valor grande si es necesario</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>      bet_w_sk <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({ <span class="fu">betweenness</span>(skill_graph, <span class="at">directed =</span> <span class="cn">FALSE</span>, <span class="at">weights =</span> weights_inv_sk, <span class="at">normalized =</span> <span class="cn">TRUE</span>) }, <span class="at">error =</span> <span class="cf">function</span>(e) {<span class="fu">warning</span>(<span class="st">"Betweenness Ponderada SK falló: "</span>,e<span class="sc">$</span>message); <span class="cn">NULL</span>})</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>      cent_bet_w_sk_df <span class="ot">&lt;-</span> <span class="fu">format_cent</span>(bet_w_sk, skill_names_map)</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print_centrality_table</span>(cent_bet_w_sk_df, <span class="st">"Intermediación Ponderada (igraph, 1/peso)"</span>, <span class="st">"Habilidades"</span>)</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Betweenness Topológica (igraph, sin ponderar) </span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>      bet_uw_sk <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({ <span class="fu">betweenness</span>(skill_graph, <span class="at">directed =</span> <span class="cn">FALSE</span>, <span class="at">weights =</span> <span class="cn">NULL</span>, <span class="at">normalized =</span> <span class="cn">TRUE</span>) }, <span class="at">error =</span> <span class="cf">function</span>(e) {<span class="fu">warning</span>(<span class="st">"Betweenness Topológica SK falló: "</span>,e<span class="sc">$</span>message); <span class="cn">NULL</span>})</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>      cent_bet_uw_sk_df <span class="ot">&lt;-</span> <span class="fu">format_cent</span>(bet_uw_sk, skill_names_map)</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print_centrality_table</span>(cent_bet_uw_sk_df, <span class="st">"Intermediación Topológica (igraph, sin peso)"</span>, <span class="st">"Habilidades"</span>)</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Eigenvector Ponderada (igraph)</span></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>      eig_sk <span class="ot">&lt;-</span> <span class="cn">NULL</span>; comp_sk <span class="ot">&lt;-</span> <span class="fu">components</span>(skill_graph)</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(comp_sk<span class="sc">$</span>no) <span class="sc">&amp;&amp;</span> (comp_sk<span class="sc">$</span>no <span class="sc">==</span> <span class="dv">1</span> <span class="sc">||</span> (<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">max</span>(comp_sk<span class="sc">$</span>csize)) <span class="sc">&amp;&amp;</span> <span class="fu">vcount</span>(skill_graph)<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">max</span>(comp_sk<span class="sc">$</span>csize)<span class="sc">/</span><span class="fu">vcount</span>(skill_graph) <span class="sc">&gt;</span> <span class="fl">0.5</span>)) ){ giant_nodes_sk <span class="ot">&lt;-</span> <span class="fu">which</span>(comp_sk<span class="sc">$</span>membership <span class="sc">==</span> <span class="fu">which.max</span>(comp_sk<span class="sc">$</span>csize)); <span class="cf">if</span>(<span class="fu">length</span>(giant_nodes_sk)<span class="sc">&gt;</span><span class="dv">1</span>){ subgraph_sk <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(skill_graph, giant_nodes_sk); <span class="cf">if</span> (<span class="fu">ecount</span>(subgraph_sk) <span class="sc">&gt;</span> <span class="dv">0</span>) { eig_sk_raw <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({ <span class="fu">eigen_centrality</span>(subgraph_sk, <span class="at">directed=</span><span class="cn">FALSE</span>, <span class="at">scale=</span><span class="cn">TRUE</span>, <span class="at">weights=</span><span class="fu">E</span>(subgraph_sk)<span class="sc">$</span>weight)<span class="sc">$</span>vector }, <span class="at">error =</span> <span class="cf">function</span>(e) {<span class="fu">warning</span>(<span class="st">"Eigenvector SK falló: "</span>,e<span class="sc">$</span>message); <span class="cn">NULL</span>}); <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(eig_sk_raw) <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(eig_sk_raw)<span class="sc">&gt;</span><span class="dv">0</span>) { eig_sk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(eig_sk_raw, <span class="fu">V</span>(subgraph_sk)<span class="sc">$</span>name) }}}}</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>      cent_eig_sk_df <span class="ot">&lt;-</span> <span class="fu">format_cent</span>(eig_sk, skill_names_map) </span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print_centrality_table</span>(cent_eig_sk_df, <span class="st">"Vector Propio Ponderado (igraph)"</span>, <span class="st">"Habilidades"</span>)</span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Guardar resultados</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>      period_centralities<span class="sc">$</span>skills <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">strength=</span>cent_str_sk_df, <span class="at">opsahl_deg=</span>cent_ops_deg_sk_df, <span class="at">betweenness_w=</span>cent_bet_w_sk_df, <span class="at">betweenness_uw =</span> cent_bet_uw_sk_df, <span class="at">eigenvector=</span>cent_eig_sk_df)</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Red de Habilidades vacía o sin enlaces.</span><span class="sc">\n</span><span class="st">"</span>) }</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- 3.2 Centralidad Red Ocupaciones ---</span></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>   <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">#### Red de Ocupaciones:</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(occ_graph) <span class="sc">&amp;&amp;</span> <span class="fu">vcount</span>(occ_graph) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">ecount</span>(occ_graph) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>       <span class="co"># Fuerza (Grado Ponderado - igraph)</span></span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>       str_oc <span class="ot">&lt;-</span> <span class="fu">strength</span>(occ_graph, <span class="at">weights =</span> <span class="fu">E</span>(occ_graph)<span class="sc">$</span>weight)</span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>       cent_str_oc_df <span class="ot">&lt;-</span> <span class="fu">format_cent_occ</span>(str_oc, occupation_titles_df)</span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>       <span class="fu">print_centrality_table</span>(cent_str_oc_df, <span class="st">"Fuerza (Grado Ponderado igraph)"</span>, <span class="st">"Ocupaciones"</span>)</span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>       <span class="co"># Grado Generalizado Opsahl (tnet)</span></span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>       ops_deg_oc <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(occ_pairs_df)) {</span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>           tnet_input_occ <span class="ot">&lt;-</span> occ_pairs_df[, .(<span class="at">i =</span> occupation1, <span class="at">j =</span> occupation2, <span class="at">w =</span> weight)]</span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>           ops_deg_occ_raw <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({ <span class="fu">degree_w</span>(tnet_input_occ, <span class="at">measure=</span><span class="fu">c</span>(<span class="st">"alpha"</span>), <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">type=</span><span class="st">"out"</span>) }, <span class="at">error=</span><span class="cf">function</span>(e) <span class="cn">NULL</span>)</span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>           <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(ops_deg_occ_raw)) { ops_deg_oc <span class="ot">&lt;-</span> <span class="fu">setNames</span>(ops_deg_occ_raw<span class="sc">$</span>output, <span class="fu">as.character</span>(ops_deg_occ_raw<span class="sc">$</span>node)) }</span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>       cent_ops_deg_oc_df <span class="ot">&lt;-</span> <span class="fu">format_cent_occ</span>(ops_deg_oc, occupation_titles_df)</span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>       <span class="fu">print_centrality_table</span>(cent_ops_deg_oc_df, <span class="st">"Grado Generalizado (Opsahl α=0.5)"</span>, <span class="st">"Ocupaciones"</span>)</span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>       <span class="co"># Betweenness Ponderada (igraph, usando 1/peso)</span></span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>       weights_inv_oc <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="fu">E</span>(occ_graph)<span class="sc">$</span>weight <span class="sc">+</span> <span class="fl">1e-9</span>) </span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>       weights_inv_oc[<span class="fu">is.infinite</span>(weights_inv_oc)] <span class="ot">&lt;-</span> <span class="fu">max</span>(weights_inv_oc[<span class="fu">is.finite</span>(weights_inv_oc)], <span class="fl">1e9</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>       bet_w_oc <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({ <span class="fu">betweenness</span>(occ_graph, <span class="at">directed =</span> <span class="cn">FALSE</span>, <span class="at">weights =</span> weights_inv_oc, <span class="at">normalized =</span> <span class="cn">TRUE</span>) }, <span class="at">error =</span> <span class="cf">function</span>(e) {<span class="fu">warning</span>(<span class="st">"Betweenness Ponderada OC falló: "</span>,e<span class="sc">$</span>message); <span class="cn">NULL</span>})</span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>       cent_bet_w_oc_df <span class="ot">&lt;-</span> <span class="fu">format_cent_occ</span>(bet_w_oc, occupation_titles_df)</span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>       <span class="fu">print_centrality_table</span>(cent_bet_w_oc_df, <span class="st">"Intermediación Ponderada (igraph, 1/peso)"</span>, <span class="st">"Ocupaciones"</span>)</span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a>       <span class="co"># Betweenness Topológica (igraph, sin ponderar)</span></span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a>       bet_uw_oc <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({ <span class="fu">betweenness</span>(occ_graph, <span class="at">directed =</span> <span class="cn">FALSE</span>, <span class="at">weights =</span> <span class="cn">NULL</span>, <span class="at">normalized =</span> <span class="cn">TRUE</span>) }, <span class="at">error =</span> <span class="cf">function</span>(e) {<span class="fu">warning</span>(<span class="st">"Betweenness Topológica OC falló: "</span>,e<span class="sc">$</span>message); <span class="cn">NULL</span>})</span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>       cent_bet_uw_oc_df <span class="ot">&lt;-</span> <span class="fu">format_cent_occ</span>(bet_uw_oc, occupation_titles_df)</span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>       <span class="fu">print_centrality_table</span>(cent_bet_uw_oc_df, <span class="st">"Intermediación Topológica (igraph, sin peso)"</span>, <span class="st">"Ocupaciones"</span>)</span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>       <span class="co"># Eigenvector Ponderada (igraph)</span></span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a>       eig_oc <span class="ot">&lt;-</span> <span class="cn">NULL</span>; comp_oc <span class="ot">&lt;-</span> <span class="fu">components</span>(occ_graph)</span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(comp_oc<span class="sc">$</span>no) <span class="sc">&amp;&amp;</span> (comp_oc<span class="sc">$</span>no <span class="sc">==</span> <span class="dv">1</span> <span class="sc">||</span> (<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">max</span>(comp_oc<span class="sc">$</span>csize)) <span class="sc">&amp;&amp;</span> <span class="fu">vcount</span>(occ_graph)<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">max</span>(comp_oc<span class="sc">$</span>csize)<span class="sc">/</span><span class="fu">vcount</span>(occ_graph) <span class="sc">&gt;</span> <span class="fl">0.5</span>))){ giant_nodes_oc <span class="ot">&lt;-</span> <span class="fu">which</span>(comp_oc<span class="sc">$</span>membership <span class="sc">==</span> <span class="fu">which.max</span>(comp_oc<span class="sc">$</span>csize)); <span class="cf">if</span>(<span class="fu">length</span>(giant_nodes_oc)<span class="sc">&gt;</span><span class="dv">1</span>){ subgraph_oc <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(occ_graph, giant_nodes_oc); <span class="cf">if</span> (<span class="fu">ecount</span>(subgraph_oc) <span class="sc">&gt;</span> <span class="dv">0</span>) { eig_oc_raw <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({ <span class="fu">eigen_centrality</span>(subgraph_oc, <span class="at">directed=</span><span class="cn">FALSE</span>, <span class="at">scale=</span><span class="cn">TRUE</span>, <span class="at">weights=</span><span class="fu">E</span>(subgraph_oc)<span class="sc">$</span>weight)<span class="sc">$</span>vector }, <span class="at">error =</span> <span class="cf">function</span>(e) {<span class="fu">warning</span>(<span class="st">"Eigenvector OC falló: "</span>,e<span class="sc">$</span>message); <span class="cn">NULL</span>}); <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(eig_oc_raw) <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(eig_oc_raw)<span class="sc">&gt;</span><span class="dv">0</span>) { eig_oc <span class="ot">&lt;-</span> <span class="fu">setNames</span>(eig_oc_raw, <span class="fu">V</span>(subgraph_oc)<span class="sc">$</span>name) }}}}</span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>       cent_eig_oc_df <span class="ot">&lt;-</span> <span class="fu">format_cent_occ</span>(eig_oc, occupation_titles_df)</span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>       <span class="fu">print_centrality_table</span>(cent_eig_oc_df, <span class="st">"Vector Propio Ponderado (igraph)"</span>, <span class="st">"Ocupaciones"</span>)</span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>       <span class="co"># Guardar resultados</span></span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>       period_centralities<span class="sc">$</span>occupations <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">strength=</span>cent_str_oc_df, <span class="at">opsahl_deg=</span>cent_ops_deg_oc_df, <span class="at">betweenness_w=</span>cent_bet_w_oc_df, <span class="at">betweenness_uw=</span>cent_bet_uw_oc_df, <span class="at">eigenvector=</span>cent_eig_oc_df)</span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Red de Ocupaciones vacía o sin enlaces.</span><span class="sc">\n</span><span class="st">"</span>) }</span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a>  all_centralities_level[[period]] <span class="ot">&lt;-</span> period_centralities </span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a>  <span class="co"># all_opsahl_degrees ya no es necesaria como variable separada si se incluye en period_centralities</span></span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a>} <span class="co"># Fin del bucle for(period in periods)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
### Análisis Período: 2005-2009 (Basado en Nivel)

**1. Creación de Grafos**
* Red Hab (Nivel): 126 nodos, 7850 enlaces.
* Red Occ (Nivel): 20 nodos, 190 enlaces.

**2. Estadísticas Descriptivas y Comunidades**</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
* **Red Habilidades:**
    * Densidad: 0.9968; Transitividad: 0.9969; Comp.: 1 (Gigante: 1.000)
    * Grado Medio: 124.60 (Pond: 55.28); Long. Camino: 0.27
    * Modularidad: 0.0619; Nº Comunidades: 3; Centr. Grado: 0.0032

* **Red Ocupaciones:**
    * Densidad: 1.0000; Transitividad: 1.0000; Comp.: 1 (Gigante: 1.000)
    * Grado Medio: 19.00 (Pond: 8.65); Long. Camino: 0.45
    * Modularidad: 0.0267; Nº Comunidades: 3; Centr. Grado: 0.0000

**3. Análisis de Centralidad (Considerando Pesos)**

#### Red de Habilidades:

#### Top 20 Habilidades por Fuerza (Grado Ponderado igraph)


| Rank|Nombre                                                   |Valor    |
|----:|:--------------------------------------------------------|:--------|
|    1|Selective Attention                                      |6.28e+01 |
|    2|Speech Clarity                                           |6.27e+01 |
|    3|Oral Comprehension                                       |6.24e+01 |
|    4|Processing Information                                   |6.23e+01 |
|    5|Time Sharing                                             |6.21e+01 |
|    6|Oral Expression                                          |6.19e+01 |
|    7|Deductive Reasoning                                      |6.17e+01 |
|    8|Training and Teaching Others                             |6.16e+01 |
|    9|Category Flexibility                                     |6.16e+01 |
|   10|Information Ordering                                     |6.16e+01 |
|   11|Updating and Using Relevant Knowledge                    |6.14e+01 |
|   12|Analyzing Data or Information                            |6.13e+01 |
|   13|Fluency of Ideas                                         |6.10e+01 |
|   14|Customer and Personal Service                            |6.10e+01 |
|   15|Developing and Building Teams                            |6.09e+01 |
|   16|Establishing and Maintaining Interpersonal Relationships |6.09e+01 |
|   17|Memorization                                             |6.08e+01 |
|   18|Speech Recognition                                       |6.07e+01 |
|   19|English Language                                         |6.05e+01 |
|   20|Auditory Attention                                       |6.03e+01 |


(No hay datos de centralidad Grado Generalizado (Opsahl α=0.5) para Habilidades)

#### Top 20 Habilidades por Intermediación Ponderada (igraph, 1/peso)


| Rank|Nombre                                          |Valor    |
|----:|:-----------------------------------------------|:--------|
|    1|Customer and Personal Service                   |5.28e-03 |
|    2|Computers and Electronics                       |5.01e-03 |
|    3|Law and Government                              |4.90e-03 |
|    4|Geography                                       |4.65e-03 |
|    5|Resolving Conflicts and Negotiating with Others |3.78e-03 |
|    6|Category Flexibility                            |3.54e-03 |
|    7|Gross Body Coordination                         |3.47e-03 |
|    8|Personnel and Human Resources                   |3.32e-03 |
|    9|Transportation                                  |3.24e-03 |
|   10|Foreign Language                                |3.08e-03 |
|   11|Biology                                         |3.08e-03 |
|   12|Stamina                                         |2.96e-03 |
|   13|Speed of Limb Movement                          |2.79e-03 |
|   14|Performing Administrative Activities            |2.71e-03 |
|   15|Number Facility                                 |2.66e-03 |
|   16|Engineering and Technology                      |2.66e-03 |
|   17|Staffing Organizational Units                   |2.60e-03 |
|   18|Sociology and Anthropology                      |2.58e-03 |
|   19|Multilimb Coordination                          |2.54e-03 |
|   20|Telecommunications                              |2.46e-03 |


#### Top 20 Habilidades por Intermediación Topológica (igraph, sin peso)


| Rank|Nombre                                                |Valor    |
|----:|:-----------------------------------------------------|:--------|
|    1|Food Production                                       |5.08e-01 |
|    2|Communications and Media                              |3.83e-02 |
|    3|Far Vision                                            |2.68e-02 |
|    4|Judging the Qualities of Objects, Services, or People |2.49e-02 |
|    5|Depth Perception                                      |2.16e-02 |
|    6|Sales and Marketing                                   |1.70e-02 |
|    7|Fine Arts                                             |1.47e-02 |
|    8|Gross Body Equilibrium                                |1.43e-02 |
|    9|History and Archeology                                |1.41e-02 |
|   10|Public Safety and Security                            |1.39e-02 |
|   11|Administrative                                        |1.36e-02 |
|   12|Reaction Time                                         |1.17e-02 |
|   13|Building and Construction                             |9.37e-03 |
|   14|Foreign Language                                      |8.39e-03 |
|   15|Visualization                                         |8.25e-03 |
|   16|Flexibility of Closure                                |7.86e-03 |
|   17|Auditory Attention                                    |7.61e-03 |
|   18|Therapy and Counseling                                |7.49e-03 |
|   19|Interpreting the Meaning of Information for Others    |7.29e-03 |
|   20|Sociology and Anthropology                            |6.97e-03 |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
#### Top 20 Habilidades por Vector Propio Ponderado (igraph)


| Rank|Nombre                                                   |Valor    |
|----:|:--------------------------------------------------------|:--------|
|    1|Selective Attention                                      |1.00e+00 |
|    2|Speech Clarity                                           |9.98e-01 |
|    3|Oral Comprehension                                       |9.92e-01 |
|    4|Processing Information                                   |9.85e-01 |
|    5|Oral Expression                                          |9.83e-01 |
|    6|Time Sharing                                             |9.82e-01 |
|    7|Deductive Reasoning                                      |9.81e-01 |
|    8|Training and Teaching Others                             |9.77e-01 |
|    9|Information Ordering                                     |9.76e-01 |
|   10|Updating and Using Relevant Knowledge                    |9.72e-01 |
|   11|Category Flexibility                                     |9.69e-01 |
|   12|Establishing and Maintaining Interpersonal Relationships |9.68e-01 |
|   13|Analyzing Data or Information                            |9.65e-01 |
|   14|Fluency of Ideas                                         |9.65e-01 |
|   15|Developing and Building Teams                            |9.64e-01 |
|   16|Speech Recognition                                       |9.62e-01 |
|   17|Memorization                                             |9.60e-01 |
|   18|English Language                                         |9.57e-01 |
|   19|Auditory Attention                                       |9.54e-01 |
|   20|Customer and Personal Service                            |9.54e-01 |


#### Red de Ocupaciones:

#### Top 20 Ocupaciones por Fuerza (Grado Ponderado igraph)


| Rank|Nombre                                                         |Valor    |
|----:|:--------------------------------------------------------------|:--------|
|    1|Refractory Materials Repairers, Except Brickmasons             |9.36e+00 |
|    2|Segmental Pavers                                               |9.21e+00 |
|    3|Floor Layers, Except Carpet, Wood, and Hard Tiles              |9.08e+00 |
|    4|Timing Device Assemblers and Adjusters                         |9.02e+00 |
|    5|Helpers--Painters, Paperhangers, Plasterers, and Stucco Masons |8.96e+00 |
|    6|Shampooers                                                     |8.92e+00 |
|    7|Transportation Security Screeners                              |8.90e+00 |
|    8|Semiconductor Processing Technicians                           |8.71e+00 |
|    9|Derrick Operators, Oil and Gas                                 |8.69e+00 |
|   10|Farm Labor Contractors                                         |8.66e+00 |
|   11|Dredge Operators                                               |8.62e+00 |
|   12|Rotary Drill Operators, Oil and Gas                            |8.61e+00 |
|   13|Gem and Diamond Workers                                        |8.57e+00 |
|   14|Stonemasons                                                    |8.54e+00 |
|   15|Fallers                                                        |8.48e+00 |
|   16|Explosives Workers, Ordnance Handling Experts, and Blasters    |8.44e+00 |
|   17|Rock Splitters, Quarry                                         |8.18e+00 |
|   18|Manufactured Building and Mobile Home Installers               |8.12e+00 |
|   19|Helpers--Roofers                                               |8.03e+00 |
|   20|Paperhangers                                                   |8.01e+00 |


(No hay datos de centralidad Grado Generalizado (Opsahl α=0.5) para Ocupaciones)

#### Top 20 Ocupaciones por Intermediación Ponderada (igraph, 1/peso)


| Rank|Nombre                                                         |Valor    |
|----:|:--------------------------------------------------------------|:--------|
|    1|Stonemasons                                                    |5.85e-03 |
|    2|Farm Labor Contractors                                         |0.00e+00 |
|    3|Transportation Security Screeners                              |0.00e+00 |
|    4|Shampooers                                                     |0.00e+00 |
|    5|Fallers                                                        |0.00e+00 |
|    6|Floor Layers, Except Carpet, Wood, and Hard Tiles              |0.00e+00 |
|    7|Paperhangers                                                   |0.00e+00 |
|    8|Helpers--Painters, Paperhangers, Plasterers, and Stucco Masons |0.00e+00 |
|    9|Helpers--Roofers                                               |0.00e+00 |
|   10|Segmental Pavers                                               |0.00e+00 |
|   11|Derrick Operators, Oil and Gas                                 |0.00e+00 |
|   12|Rotary Drill Operators, Oil and Gas                            |0.00e+00 |
|   13|Explosives Workers, Ordnance Handling Experts, and Blasters    |0.00e+00 |
|   14|Rock Splitters, Quarry                                         |0.00e+00 |
|   15|Refractory Materials Repairers, Except Brickmasons             |0.00e+00 |
|   16|Manufactured Building and Mobile Home Installers               |0.00e+00 |
|   17|Timing Device Assemblers and Adjusters                         |0.00e+00 |
|   18|Gem and Diamond Workers                                        |0.00e+00 |
|   19|Semiconductor Processing Technicians                           |0.00e+00 |
|   20|Dredge Operators                                               |0.00e+00 |


#### Top 20 Ocupaciones por Intermediación Topológica (igraph, sin peso)


| Rank|Nombre                                                         |Valor    |
|----:|:--------------------------------------------------------------|:--------|
|    1|Manufactured Building and Mobile Home Installers               |2.34e-02 |
|    2|Fallers                                                        |2.05e-02 |
|    3|Explosives Workers, Ordnance Handling Experts, and Blasters    |1.75e-02 |
|    4|Shampooers                                                     |5.85e-03 |
|    5|Helpers--Roofers                                               |5.85e-03 |
|    6|Dredge Operators                                               |5.85e-03 |
|    7|Farm Labor Contractors                                         |0.00e+00 |
|    8|Transportation Security Screeners                              |0.00e+00 |
|    9|Stonemasons                                                    |0.00e+00 |
|   10|Floor Layers, Except Carpet, Wood, and Hard Tiles              |0.00e+00 |
|   11|Paperhangers                                                   |0.00e+00 |
|   12|Helpers--Painters, Paperhangers, Plasterers, and Stucco Masons |0.00e+00 |
|   13|Segmental Pavers                                               |0.00e+00 |
|   14|Derrick Operators, Oil and Gas                                 |0.00e+00 |
|   15|Rotary Drill Operators, Oil and Gas                            |0.00e+00 |
|   16|Rock Splitters, Quarry                                         |0.00e+00 |
|   17|Refractory Materials Repairers, Except Brickmasons             |0.00e+00 |
|   18|Timing Device Assemblers and Adjusters                         |0.00e+00 |
|   19|Gem and Diamond Workers                                        |0.00e+00 |
|   20|Semiconductor Processing Technicians                           |0.00e+00 |


#### Top 20 Ocupaciones por Vector Propio Ponderado (igraph)


| Rank|Nombre                                                         |Valor    |
|----:|:--------------------------------------------------------------|:--------|
|    1|Refractory Materials Repairers, Except Brickmasons             |1.00e+00 |
|    2|Segmental Pavers                                               |9.82e-01 |
|    3|Floor Layers, Except Carpet, Wood, and Hard Tiles              |9.70e-01 |
|    4|Timing Device Assemblers and Adjusters                         |9.68e-01 |
|    5|Helpers--Painters, Paperhangers, Plasterers, and Stucco Masons |9.59e-01 |
|    6|Shampooers                                                     |9.55e-01 |
|    7|Transportation Security Screeners                              |9.54e-01 |
|    8|Semiconductor Processing Technicians                           |9.36e-01 |
|    9|Farm Labor Contractors                                         |9.27e-01 |
|   10|Derrick Operators, Oil and Gas                                 |9.26e-01 |
|   11|Dredge Operators                                               |9.24e-01 |
|   12|Gem and Diamond Workers                                        |9.21e-01 |
|   13|Rotary Drill Operators, Oil and Gas                            |9.20e-01 |
|   14|Stonemasons                                                    |9.12e-01 |
|   15|Fallers                                                        |9.08e-01 |
|   16|Explosives Workers, Ordnance Handling Experts, and Blasters    |9.03e-01 |
|   17|Rock Splitters, Quarry                                         |8.74e-01 |
|   18|Manufactured Building and Mobile Home Installers               |8.68e-01 |
|   19|Helpers--Roofers                                               |8.59e-01 |
|   20|Paperhangers                                                   |8.57e-01 |


### Análisis Período: 2010-2014 (Basado en Nivel)

**1. Creación de Grafos**
* Red Hab (Nivel): 161 nodos, 12733 enlaces.
* Red Occ (Nivel): 89 nodos, 3839 enlaces.

**2. Estadísticas Descriptivas y Comunidades**

* **Red Habilidades:**
    * Densidad: 0.9886; Transitividad: 0.9895; Comp.: 1 (Gigante: 1.000)
    * Grado Medio: 158.17 (Pond: 63.54); Long. Camino: 0.12
    * Modularidad: 0.1229; Nº Comunidades: 3; Centr. Grado: 0.0114

* **Red Ocupaciones:**
    * Densidad: 0.9803; Transitividad: 0.9843; Comp.: 1 (Gigante: 1.000)
    * Grado Medio: 86.27 (Pond: 32.66); Long. Camino: 0.12
    * Modularidad: 0.2040; Nº Comunidades: 2; Centr. Grado: 0.0197

**3. Análisis de Centralidad (Considerando Pesos)**

#### Red de Habilidades:

#### Top 20 Habilidades por Fuerza (Grado Ponderado igraph)


| Rank|Nombre                                                 |Valor    |
|----:|:------------------------------------------------------|:--------|
|    1|Written Expression                                     |7.68e+01 |
|    2|Inductive Reasoning                                    |7.67e+01 |
|    3|Documenting/Recording Information                      |7.65e+01 |
|    4|Deductive Reasoning                                    |7.65e+01 |
|    5|Problem Sensitivity                                    |7.64e+01 |
|    6|Written Comprehension                                  |7.64e+01 |
|    7|Updating and Using Relevant Knowledge                  |7.63e+01 |
|    8|Communicating with Supervisors, Peers, or Subordinates |7.63e+01 |
|    9|Near Vision                                            |7.62e+01 |
|   10|Flexibility of Closure                                 |7.61e+01 |
|   11|Identifying Objects, Actions, and Events               |7.59e+01 |
|   12|Information Ordering                                   |7.59e+01 |
|   13|Getting Information                                    |7.57e+01 |
|   14|Working with Computers                                 |7.56e+01 |
|   15|Speed of Closure                                       |7.55e+01 |
|   16|Analyzing Data or Information                          |7.55e+01 |
|   17|Category Flexibility                                   |7.55e+01 |
|   18|Customer and Personal Service                          |7.54e+01 |
|   19|Coordinating the Work and Activities of Others         |7.52e+01 |
|   20|Oral Expression                                        |7.52e+01 |


(No hay datos de centralidad Grado Generalizado (Opsahl α=0.5) para Habilidades)

#### Top 20 Habilidades por Intermediación Ponderada (igraph, 1/peso)


| Rank|Nombre                                         |Valor    |
|----:|:----------------------------------------------|:--------|
|    1|Systems Evaluation                             |5.08e-02 |
|    2|Operation and Control                          |3.36e-02 |
|    3|Troubleshooting                                |2.56e-02 |
|    4|Management of Financial Resources              |1.86e-02 |
|    5|Science                                        |1.64e-02 |
|    6|Operations Analysis                            |1.27e-02 |
|    7|Installation                                   |9.04e-03 |
|    8|Social Perceptiveness                          |6.68e-03 |
|    9|Response Orientation                           |6.47e-03 |
|   10|Repairing                                      |6.37e-03 |
|   11|Equipment Maintenance                          |6.05e-03 |
|   12|Equipment Selection                            |5.82e-03 |
|   13|Technology Design                              |5.11e-03 |
|   14|Gross Body Equilibrium                         |3.69e-03 |
|   15|Depth Perception                               |3.62e-03 |
|   16|Repairing and Maintaining Electronic Equipment |3.62e-03 |
|   17|Production and Processing                      |3.50e-03 |
|   18|Systems Analysis                               |3.14e-03 |
|   19|Management of Material Resources               |2.67e-03 |
|   20|Arm-Hand Steadiness                            |2.47e-03 |


#### Top 20 Habilidades por Intermediación Topológica (igraph, sin peso)


| Rank|Nombre                                         |Valor    |
|----:|:----------------------------------------------|:--------|
|    1|Instructing                                    |2.06e-01 |
|    2|Management of Personnel Resources              |1.86e-01 |
|    3|Time Management                                |1.42e-01 |
|    4|Coordination                                   |1.05e-01 |
|    5|Operations Monitoring                          |8.33e-02 |
|    6|Installation                                   |4.86e-02 |
|    7|Food Production                                |4.11e-02 |
|    8|Explosive Strength                             |3.84e-02 |
|    9|Critical Thinking                              |3.30e-02 |
|   10|Response Orientation                           |3.27e-02 |
|   11|Inspecting Equipment, Structures, or Materials |2.90e-02 |
|   12|Dynamic Flexibility                            |2.23e-02 |
|   13|Monitoring                                     |2.14e-02 |
|   14|Reaction Time                                  |1.88e-02 |
|   15|Philosophy and Theology                        |1.87e-02 |
|   16|Economics and Accounting                       |1.69e-02 |
|   17|Medicine and Dentistry                         |1.69e-02 |
|   18|Dynamic Strength                               |1.65e-02 |
|   19|Writing                                        |1.63e-02 |
|   20|Complex Problem Solving                        |1.57e-02 |


#### Top 20 Habilidades por Vector Propio Ponderado (igraph)


| Rank|Nombre                                                        |Valor    |
|----:|:-------------------------------------------------------------|:--------|
|    1|Documenting/Recording Information                             |1.00e+00 |
|    2|Written Expression                                            |9.97e-01 |
|    3|Updating and Using Relevant Knowledge                         |9.96e-01 |
|    4|Inductive Reasoning                                           |9.94e-01 |
|    5|Identifying Objects, Actions, and Events                      |9.92e-01 |
|    6|Problem Sensitivity                                           |9.92e-01 |
|    7|Written Comprehension                                         |9.90e-01 |
|    8|Deductive Reasoning                                           |9.90e-01 |
|    9|Flexibility of Closure                                        |9.89e-01 |
|   10|Near Vision                                                   |9.87e-01 |
|   11|Communicating with Supervisors, Peers, or Subordinates        |9.86e-01 |
|   12|Working with Computers                                        |9.82e-01 |
|   13|Analyzing Data or Information                                 |9.80e-01 |
|   14|Getting Information                                           |9.80e-01 |
|   15|Information Ordering                                          |9.79e-01 |
|   16|Evaluating Information to Determine Compliance with Standards |9.79e-01 |
|   17|Speed of Closure                                              |9.79e-01 |
|   18|Coordinating the Work and Activities of Others                |9.77e-01 |
|   19|Response Orientation                                          |9.76e-01 |
|   20|Selective Attention                                           |9.76e-01 |


#### Red de Ocupaciones:

#### Top 20 Ocupaciones por Fuerza (Grado Ponderado igraph)


| Rank|Nombre                                                         |Valor    |
|----:|:--------------------------------------------------------------|:--------|
|    1|Medical and Clinical Laboratory Technicians                    |3.83e+01 |
|    2|Nuclear Monitoring Technicians                                 |3.82e+01 |
|    3|Electrical and Electronic Equipment Assemblers                 |3.80e+01 |
|    4|Diagnostic Medical Sonographers                                |3.79e+01 |
|    5|Cardiovascular Technologists and Technicians                   |3.79e+01 |
|    6|Sports Medicine Physicians                                     |3.77e+01 |
|    7|Medical and Clinical Laboratory Technologists                  |3.75e+01 |
|    8|Nuclear Power Reactor Operators                                |3.74e+01 |
|    9|Anesthesiologist Assistants                                    |3.74e+01 |
|   10|Remote Sensing Technicians                                     |3.72e+01 |
|   11|Nuclear Medicine Technologists                                 |3.72e+01 |
|   12|Customs and Border Protection Officers                         |3.66e+01 |
|   13|Surgical Technologists                                         |3.66e+01 |
|   14|Bioinformatics Scientists                                      |3.66e+01 |
|   15|Reservation and Transportation Ticket Agents and Travel Clerks |3.66e+01 |
|   16|Home Health Aides                                              |3.66e+01 |
|   17|Genetic Counselors                                             |3.65e+01 |
|   18|Computer Network Support Specialists                           |3.64e+01 |
|   19|Oral and Maxillofacial Surgeons                                |3.64e+01 |
|   20|Gambling and Sports Book Writers and Runners                   |3.64e+01 |


(No hay datos de centralidad Grado Generalizado (Opsahl α=0.5) para Ocupaciones)

#### Top 20 Ocupaciones por Intermediación Ponderada (igraph, 1/peso)


| Rank|Nombre                                                                                |Valor    |
|----:|:-------------------------------------------------------------------------------------|:--------|
|    1|Sales Representatives, Wholesale and Manufacturing, Technical and Scientific Products |2.62e-01 |
|    2|Brokerage Clerks                                                                      |3.42e-02 |
|    3|Psychiatrists                                                                         |2.56e-02 |
|    4|Environmental Engineering Technologists and Technicians                               |2.38e-02 |
|    5|Locker Room, Coatroom, and Dressing Room Attendants                                   |1.83e-02 |
|    6|Nuclear Power Reactor Operators                                                       |9.54e-03 |
|    7|Computer Network Support Specialists                                                  |6.27e-03 |
|    8|Nuclear Monitoring Technicians                                                        |4.83e-03 |
|    9|Anesthesiologist Assistants                                                           |2.35e-03 |
|   10|Customs and Border Protection Officers                                                |2.35e-03 |
|   11|Sports Medicine Physicians                                                            |2.09e-03 |
|   12|Timing Device Assemblers and Adjusters                                                |2.09e-03 |
|   13|Semiconductor Processing Technicians                                                  |2.09e-03 |
|   14|Animal Trainers                                                                       |1.31e-03 |
|   15|Reservation and Transportation Ticket Agents and Travel Clerks                        |1.31e-03 |
|   16|Painters, Construction and Maintenance                                                |1.31e-03 |
|   17|Electrical and Electronic Equipment Assemblers                                        |1.31e-03 |
|   18|Medical and Clinical Laboratory Technicians                                           |1.04e-03 |
|   19|Recycling Coordinators                                                                |1.04e-03 |
|   20|Cardiovascular Technologists and Technicians                                          |7.84e-04 |


#### Top 20 Ocupaciones por Intermediación Topológica (igraph, sin peso)


| Rank|Nombre                                                                      |Valor    |
|----:|:---------------------------------------------------------------------------|:--------|
|    1|Helpers--Painters, Paperhangers, Plasterers, and Stucco Masons              |3.12e-01 |
|    2|Farm Labor Contractors                                                      |2.86e-01 |
|    3|Pharmacy Aides                                                              |1.95e-01 |
|    4|Shampooers                                                                  |7.52e-02 |
|    5|Floor Layers, Except Carpet, Wood, and Hard Tiles                           |6.12e-02 |
|    6|Helpers--Carpenters                                                         |5.02e-02 |
|    7|Retail Loss Prevention Specialists                                          |4.81e-02 |
|    8|Rock Splitters, Quarry                                                      |3.15e-02 |
|    9|Sports Medicine Physicians                                                  |2.93e-02 |
|   10|Derrick Operators, Oil and Gas                                              |2.51e-02 |
|   11|Industrial Engineering Technologists and Technicians                        |2.01e-02 |
|   12|Physical Medicine and Rehabilitation Physicians                             |1.96e-02 |
|   13|Bioinformatics Technicians                                                  |1.88e-02 |
|   14|Tire Repairers and Changers                                                 |1.83e-02 |
|   15|Animal Trainers                                                             |1.57e-02 |
|   16|Fallers                                                                     |1.07e-02 |
|   17|Helpers--Roofers                                                            |1.00e-02 |
|   18|Helpers--Brickmasons, Blockmasons, Stonemasons, and Tile and Marble Setters |9.93e-03 |
|   19|Segmental Pavers                                                            |4.26e-03 |
|   20|Rotary Drill Operators, Oil and Gas                                         |4.26e-03 |


#### Top 20 Ocupaciones por Vector Propio Ponderado (igraph)


| Rank|Nombre                                                         |Valor    |
|----:|:--------------------------------------------------------------|:--------|
|    1|Nuclear Monitoring Technicians                                 |1.00e+00 |
|    2|Medical and Clinical Laboratory Technicians                    |9.97e-01 |
|    3|Sports Medicine Physicians                                     |9.96e-01 |
|    4|Cardiovascular Technologists and Technicians                   |9.89e-01 |
|    5|Diagnostic Medical Sonographers                                |9.83e-01 |
|    6|Anesthesiologist Assistants                                    |9.79e-01 |
|    7|Electrical and Electronic Equipment Assemblers                 |9.79e-01 |
|    8|Nuclear Power Reactor Operators                                |9.76e-01 |
|    9|Customs and Border Protection Officers                         |9.76e-01 |
|   10|Nuclear Medicine Technologists                                 |9.72e-01 |
|   11|Medical and Clinical Laboratory Technologists                  |9.64e-01 |
|   12|Oral and Maxillofacial Surgeons                                |9.62e-01 |
|   13|Reservation and Transportation Ticket Agents and Travel Clerks |9.58e-01 |
|   14|Home Health Aides                                              |9.57e-01 |
|   15|Remote Sensing Technicians                                     |9.54e-01 |
|   16|Chiropractors                                                  |9.53e-01 |
|   17|Surgical Technologists                                         |9.48e-01 |
|   18|File Clerks                                                    |9.46e-01 |
|   19|Respiratory Therapists                                         |9.42e-01 |
|   20|Acute Care Nurses                                              |9.40e-01 |


### Análisis Período: 2015-2019 (Basado en Nivel)

**1. Creación de Grafos**
* Red Hab (Nivel): 161 nodos, 12880 enlaces.
* Red Occ (Nivel): 332 nodos, 54940 enlaces.

**2. Estadísticas Descriptivas y Comunidades**

* **Red Habilidades:**
    * Densidad: 1.0000; Transitividad: 1.0000; Comp.: 1 (Gigante: 1.000)
    * Grado Medio: 160.00 (Pond: 70.14); Long. Camino: 0.24
    * Modularidad: 0.1642; Nº Comunidades: 2; Centr. Grado: 0.0000

* **Red Ocupaciones:**
    * Densidad: 0.9999; Transitividad: 0.9999; Comp.: 1 (Gigante: 1.000)
    * Grado Medio: 330.96 (Pond: 148.06); Long. Camino: 0.28
    * Modularidad: 0.1819; Nº Comunidades: 2; Centr. Grado: 0.0001

**3. Análisis de Centralidad (Considerando Pesos)**

#### Red de Habilidades:

#### Top 20 Habilidades por Fuerza (Grado Ponderado igraph)


| Rank|Nombre                                                   |Valor    |
|----:|:--------------------------------------------------------|:--------|
|    1|Active Listening                                         |7.99e+01 |
|    2|Inductive Reasoning                                      |7.93e+01 |
|    3|Critical Thinking                                        |7.91e+01 |
|    4|Monitoring                                               |7.89e+01 |
|    5|Active Learning                                          |7.88e+01 |
|    6|Reading Comprehension                                    |7.87e+01 |
|    7|Deductive Reasoning                                      |7.87e+01 |
|    8|Originality                                              |7.85e+01 |
|    9|Fluency of Ideas                                         |7.83e+01 |
|   10|Speaking                                                 |7.83e+01 |
|   11|Communicating with People Outside the Organization       |7.82e+01 |
|   12|Establishing and Maintaining Interpersonal Relationships |7.81e+01 |
|   13|Written Comprehension                                    |7.81e+01 |
|   14|Organizing, Planning, and Prioritizing Work              |7.80e+01 |
|   15|Time Management                                          |7.79e+01 |
|   16|Persuasion                                               |7.79e+01 |
|   17|Memorization                                             |7.77e+01 |
|   18|Social Perceptiveness                                    |7.77e+01 |
|   19|Service Orientation                                      |7.77e+01 |
|   20|Oral Comprehension                                       |7.77e+01 |


(No hay datos de centralidad Grado Generalizado (Opsahl α=0.5) para Habilidades)

#### Top 20 Habilidades por Intermediación Ponderada (igraph, 1/peso)


| Rank|Nombre                                                                          |Valor    |
|----:|:-------------------------------------------------------------------------------|:--------|
|    1|Public Safety and Security                                                      |2.36e-02 |
|    2|Time Sharing                                                                    |2.31e-02 |
|    3|Flexibility of Closure                                                          |2.15e-02 |
|    4|Selective Attention                                                             |1.64e-02 |
|    5|Estimating the Quantifiable Characteristics of Products, Events, or Information |1.63e-02 |
|    6|Monitoring Processes, Materials, or Surroundings                                |1.14e-02 |
|    7|Assisting and Caring for Others                                                 |1.13e-02 |
|    8|Category Flexibility                                                            |1.11e-02 |
|    9|Performing for or Working Directly with the Public                              |1.01e-02 |
|   10|Engineering and Technology                                                      |8.96e-03 |
|   11|Far Vision                                                                      |8.49e-03 |
|   12|Design                                                                          |7.47e-03 |
|   13|Mathematics                                                                     |5.03e-03 |
|   14|Visualization                                                                   |4.87e-03 |
|   15|Monitoring and Controlling Resources                                            |4.17e-03 |
|   16|Speed of Closure                                                                |4.01e-03 |
|   17|Information Ordering                                                            |3.85e-03 |
|   18|Production and Processing                                                       |3.62e-03 |
|   19|Operations Analysis                                                             |3.38e-03 |
|   20|Perceptual Speed                                                                |2.91e-03 |


#### Top 20 Habilidades por Intermediación Topológica (igraph, sin peso)


| Rank|Nombre                                             |Valor    |
|----:|:--------------------------------------------------|:--------|
|    1|Installation                                       |5.35e-01 |
|    2|Dynamic Flexibility                                |8.08e-02 |
|    3|Writing                                            |5.53e-02 |
|    4|Sociology and Anthropology                         |5.31e-02 |
|    5|Speaking                                           |5.24e-02 |
|    6|Philosophy and Theology                            |4.95e-02 |
|    7|Written Expression                                 |3.60e-02 |
|    8|Speech Clarity                                     |3.53e-02 |
|    9|History and Archeology                             |2.11e-02 |
|   10|English Language                                   |1.22e-02 |
|   11|Interpreting the Meaning of Information for Others |9.20e-03 |
|   12|Social Perceptiveness                              |8.33e-03 |
|   13|Analyzing Data or Information                      |7.31e-03 |
|   14|Therapy and Counseling                             |6.09e-03 |
|   15|Fine Arts                                          |5.03e-03 |
|   16|Peripheral Vision                                  |3.56e-03 |
|   17|Glare Sensitivity                                  |2.20e-03 |
|   18|Night Vision                                       |2.03e-03 |
|   19|Active Learning                                    |9.43e-04 |
|   20|Programming                                        |2.36e-04 |


#### Top 20 Habilidades por Vector Propio Ponderado (igraph)


| Rank|Nombre                                                   |Valor    |
|----:|:--------------------------------------------------------|:--------|
|    1|Active Listening                                         |1.00e+00 |
|    2|Critical Thinking                                        |9.92e-01 |
|    3|Inductive Reasoning                                      |9.90e-01 |
|    4|Active Learning                                          |9.88e-01 |
|    5|Reading Comprehension                                    |9.88e-01 |
|    6|Speaking                                                 |9.84e-01 |
|    7|Deductive Reasoning                                      |9.83e-01 |
|    8|Monitoring                                               |9.81e-01 |
|    9|Originality                                              |9.80e-01 |
|   10|Fluency of Ideas                                         |9.79e-01 |
|   11|Written Comprehension                                    |9.78e-01 |
|   12|Social Perceptiveness                                    |9.73e-01 |
|   13|Establishing and Maintaining Interpersonal Relationships |9.71e-01 |
|   14|Persuasion                                               |9.71e-01 |
|   15|Organizing, Planning, and Prioritizing Work              |9.71e-01 |
|   16|Time Management                                          |9.70e-01 |
|   17|Oral Comprehension                                       |9.70e-01 |
|   18|Oral Expression                                          |9.69e-01 |
|   19|Communicating with People Outside the Organization       |9.68e-01 |
|   20|Written Expression                                       |9.67e-01 |


#### Red de Ocupaciones:

#### Top 20 Ocupaciones por Fuerza (Grado Ponderado igraph)


| Rank|Nombre                                                                      |Valor    |
|----:|:---------------------------------------------------------------------------|:--------|
|    1|Mail Clerks and Mail Machine Operators, Except Postal Service               |1.62e+02 |
|    2|Gambling Change Persons and Booth Cashiers                                  |1.62e+02 |
|    3|Cutters and Trimmers, Hand                                                  |1.61e+02 |
|    4|Fabric and Apparel Patternmakers                                            |1.60e+02 |
|    5|Office Machine Operators, Except Computer                                   |1.60e+02 |
|    6|Chemical Plant and System Operators                                         |1.60e+02 |
|    7|Cooks, Fast Food                                                            |1.60e+02 |
|    8|Photographic Process Workers and Processing Machine Operators               |1.59e+02 |
|    9|Painting, Coating, and Decorating Workers                                   |1.59e+02 |
|   10|Tellers                                                                     |1.59e+02 |
|   11|Passenger Attendants                                                        |1.58e+02 |
|   12|Bartenders                                                                  |1.58e+02 |
|   13|Library Technicians                                                         |1.58e+02 |
|   14|Cooks, Institution and Cafeteria                                            |1.58e+02 |
|   15|Laundry and Dry-Cleaning Workers                                            |1.58e+02 |
|   16|Food and Tobacco Roasting, Baking, and Drying Machine Operators and Tenders |1.57e+02 |
|   17|Ushers, Lobby Attendants, and Ticket Takers                                 |1.57e+02 |
|   18|Childcare Workers                                                           |1.57e+02 |
|   19|Transportation Vehicle, Equipment and Systems Inspectors, Except Aviation   |1.57e+02 |
|   20|Postal Service Clerks                                                       |1.57e+02 |


(No hay datos de centralidad Grado Generalizado (Opsahl α=0.5) para Ocupaciones)

#### Top 20 Ocupaciones por Intermediación Ponderada (igraph, 1/peso)


| Rank|Nombre                                                             |Valor    |
|----:|:------------------------------------------------------------------|:--------|
|    1|Gambling Change Persons and Booth Cashiers                         |1.87e-02 |
|    2|Police Identification and Records Officers                         |1.74e-02 |
|    3|Mail Clerks and Mail Machine Operators, Except Postal Service      |1.63e-02 |
|    4|Fabric and Apparel Patternmakers                                   |1.48e-02 |
|    5|Biological Technicians                                             |1.07e-02 |
|    6|Crossing Guards and Flaggers                                       |1.06e-02 |
|    7|Prepress Technicians and Workers                                   |9.86e-03 |
|    8|Forest Fire Inspectors and Prevention Specialists                  |9.77e-03 |
|    9|Costume Attendants                                                 |9.20e-03 |
|   10|Passenger Attendants                                               |8.40e-03 |
|   11|Microsystems Engineers                                             |6.90e-03 |
|   12|Photographic Process Workers and Processing Machine Operators      |6.00e-03 |
|   13|Painting, Coating, and Decorating Workers                          |5.27e-03 |
|   14|Cooks, Institution and Cafeteria                                   |4.78e-03 |
|   15|Aerospace Engineering and Operations Technologists and Technicians |4.28e-03 |
|   16|Cooks, Fast Food                                                   |4.06e-03 |
|   17|Traffic Technicians                                                |3.97e-03 |
|   18|Cutters and Trimmers, Hand                                         |3.89e-03 |
|   19|Museum Technicians and Conservators                                |3.64e-03 |
|   20|Hydroelectric Production Managers                                  |3.48e-03 |


#### Top 20 Ocupaciones por Intermediación Topológica (igraph, sin peso)


| Rank|Nombre                                                             |Valor    |
|----:|:------------------------------------------------------------------|:--------|
|    1|Rail Car Repairers                                                 |2.48e-01 |
|    2|Proofreaders and Copy Markers                                      |6.13e-02 |
|    3|Sociology Teachers, Postsecondary                                  |5.55e-02 |
|    4|Law Teachers, Postsecondary                                        |5.01e-02 |
|    5|Area, Ethnic, and Cultural Studies Teachers, Postsecondary         |3.90e-02 |
|    6|Crane and Tower Operators                                          |3.57e-02 |
|    7|Pipelayers                                                         |3.13e-02 |
|    8|Education and Childcare Administrators, Preschool and Daycare      |2.45e-02 |
|    9|Psychology Teachers, Postsecondary                                 |2.38e-02 |
|   10|Health Education Specialists                                       |1.75e-02 |
|   11|Farm Equipment Mechanics and Service Technicians                   |1.65e-02 |
|   12|Business Teachers, Postsecondary                                   |1.58e-02 |
|   13|Mobile Heavy Equipment Mechanics, Except Engines                   |1.39e-02 |
|   14|English Language and Literature Teachers, Postsecondary            |1.24e-02 |
|   15|Forging Machine Setters, Operators, and Tenders, Metal and Plastic |8.64e-03 |
|   16|Avionics Technicians                                               |8.22e-03 |
|   17|Boilermakers                                                       |7.07e-03 |
|   18|Commercial Divers                                                  |6.95e-03 |
|   19|Postmasters and Mail Superintendents                               |6.13e-03 |
|   20|Chemistry Teachers, Postsecondary                                  |5.84e-03 |


#### Top 20 Ocupaciones por Vector Propio Ponderado (igraph)


| Rank|Nombre                                                        |Valor    |
|----:|:-------------------------------------------------------------|:--------|
|    1|Mail Clerks and Mail Machine Operators, Except Postal Service |1.00e+00 |
|    2|Gambling Change Persons and Booth Cashiers                    |9.98e-01 |
|    3|Cutters and Trimmers, Hand                                    |9.93e-01 |
|    4|Fabric and Apparel Patternmakers                              |9.90e-01 |
|    5|Cooks, Fast Food                                              |9.88e-01 |
|    6|Office Machine Operators, Except Computer                     |9.86e-01 |
|    7|Chemical Plant and System Operators                           |9.84e-01 |
|    8|Painting, Coating, and Decorating Workers                     |9.83e-01 |
|    9|Photographic Process Workers and Processing Machine Operators |9.83e-01 |
|   10|Tellers                                                       |9.82e-01 |
|   11|Library Technicians                                           |9.76e-01 |
|   12|Passenger Attendants                                          |9.76e-01 |
|   13|Bartenders                                                    |9.75e-01 |
|   14|Childcare Workers                                             |9.73e-01 |
|   15|Cooks, Institution and Cafeteria                              |9.72e-01 |
|   16|Library Assistants, Clerical                                  |9.71e-01 |
|   17|Ushers, Lobby Attendants, and Ticket Takers                   |9.71e-01 |
|   18|Floral Designers                                              |9.70e-01 |
|   19|Laundry and Dry-Cleaning Workers                              |9.69e-01 |
|   20|Postal Service Clerks                                         |9.69e-01 |


### Análisis Período: 2020-2024 (Basado en Nivel)

**1. Creación de Grafos**
* Red Hab (Nivel): 161 nodos, 12880 enlaces.
* Red Occ (Nivel): 458 nodos, 104653 enlaces.

**2. Estadísticas Descriptivas y Comunidades**

* **Red Habilidades:**
    * Densidad: 1.0000; Transitividad: 1.0000; Comp.: 1 (Gigante: 1.000)
    * Grado Medio: 160.00 (Pond: 69.34); Long. Camino: 0.24
    * Modularidad: 0.1353; Nº Comunidades: 2; Centr. Grado: 0.0000

* **Red Ocupaciones:**
    * Densidad: 1.0000; Transitividad: 1.0000; Comp.: 1 (Gigante: 1.000)
    * Grado Medio: 457.00 (Pond: 201.18); Long. Camino: 0.29
    * Modularidad: 0.1422; Nº Comunidades: 2; Centr. Grado: 0.0000

**3. Análisis de Centralidad (Considerando Pesos)**

#### Red de Habilidades:

#### Top 20 Habilidades por Fuerza (Grado Ponderado igraph)


| Rank|Nombre                       |Valor    |
|----:|:----------------------------|:--------|
|    1|Writing                      |7.83e+01 |
|    2|Written Comprehension        |7.80e+01 |
|    3|Written Expression           |7.80e+01 |
|    4|Reading Comprehension        |7.80e+01 |
|    5|Oral Expression              |7.79e+01 |
|    6|Fluency of Ideas             |7.78e+01 |
|    7|Active Learning              |7.77e+01 |
|    8|Critical Thinking            |7.76e+01 |
|    9|Judgment and Decision Making |7.73e+01 |
|   10|Learning Strategies          |7.72e+01 |
|   11|Oral Comprehension           |7.70e+01 |
|   12|Systems Analysis             |7.69e+01 |
|   13|Complex Problem Solving      |7.68e+01 |
|   14|Instructing                  |7.68e+01 |
|   15|Systems Evaluation           |7.68e+01 |
|   16|Getting Information          |7.67e+01 |
|   17|Active Listening             |7.66e+01 |
|   18|Speaking                     |7.65e+01 |
|   19|Monitoring                   |7.65e+01 |
|   20|Deductive Reasoning          |7.64e+01 |


(No hay datos de centralidad Grado Generalizado (Opsahl α=0.5) para Habilidades)

#### Top 20 Habilidades por Intermediación Ponderada (igraph, 1/peso)


| Rank|Nombre                                             |Valor    |
|----:|:--------------------------------------------------|:--------|
|    1|Perceptual Speed                                   |2.47e-02 |
|    2|Time Sharing                                       |2.43e-02 |
|    3|Monitoring Processes, Materials, or Surroundings   |1.18e-02 |
|    4|Performing for or Working Directly with the Public |1.08e-02 |
|    5|Mathematics                                        |8.10e-03 |
|    6|Selective Attention                                |7.08e-03 |
|    7|Engineering and Technology                         |7.00e-03 |
|    8|Transportation                                     |6.29e-03 |
|    9|Far Vision                                         |5.94e-03 |
|   10|Visualization                                      |5.27e-03 |
|   11|Monitoring and Controlling Resources               |5.27e-03 |
|   12|Near Vision                                        |5.03e-03 |
|   13|Public Safety and Security                         |4.01e-03 |
|   14|Design                                             |3.93e-03 |
|   15|Production and Processing                          |3.46e-03 |
|   16|Quality Control Analysis                           |3.22e-03 |
|   17|Trunk Strength                                     |3.14e-03 |
|   18|Multilimb Coordination                             |2.67e-03 |
|   19|Chemistry                                          |2.36e-03 |
|   20|Mathematics                                        |2.20e-03 |


#### Top 20 Habilidades por Intermediación Topológica (igraph, sin peso)


| Rank|Nombre                        |Valor    |
|----:|:-----------------------------|:--------|
|    1|Installation                  |5.48e-01 |
|    2|Dynamic Flexibility           |9.90e-02 |
|    3|Social Perceptiveness         |4.88e-02 |
|    4|Therapy and Counseling        |4.79e-02 |
|    5|Complex Problem Solving       |3.96e-02 |
|    6|Speech Clarity                |3.92e-02 |
|    7|History and Archeology        |3.46e-02 |
|    8|Fine Arts                     |2.39e-02 |
|    9|Speaking                      |2.33e-02 |
|   10|Inductive Reasoning           |1.63e-02 |
|   11|Sociology and Anthropology    |1.19e-02 |
|   12|Critical Thinking             |1.16e-02 |
|   13|Analyzing Data or Information |9.12e-03 |
|   14|Written Expression            |6.37e-03 |
|   15|Active Learning               |2.99e-03 |
|   16|Philosophy and Theology       |2.59e-03 |
|   17|Writing                       |2.44e-03 |
|   18|Deductive Reasoning           |1.06e-03 |
|   19|Active Listening              |9.43e-04 |
|   20|Service Orientation           |7.86e-04 |


#### Top 20 Habilidades por Vector Propio Ponderado (igraph)


| Rank|Nombre                       |Valor    |
|----:|:----------------------------|:--------|
|    1|Writing                      |1.00e+00 |
|    2|Written Expression           |9.98e-01 |
|    3|Reading Comprehension        |9.97e-01 |
|    4|Written Comprehension        |9.97e-01 |
|    5|Oral Expression              |9.94e-01 |
|    6|Active Learning              |9.93e-01 |
|    7|Critical Thinking            |9.93e-01 |
|    8|Fluency of Ideas             |9.90e-01 |
|    9|Judgment and Decision Making |9.86e-01 |
|   10|Learning Strategies          |9.81e-01 |
|   11|Oral Comprehension           |9.81e-01 |
|   12|Complex Problem Solving      |9.80e-01 |
|   13|Speaking                     |9.78e-01 |
|   14|Active Listening             |9.78e-01 |
|   15|Deductive Reasoning          |9.76e-01 |
|   16|Getting Information          |9.75e-01 |
|   17|Systems Analysis             |9.74e-01 |
|   18|Instructing                  |9.74e-01 |
|   19|Systems Evaluation           |9.73e-01 |
|   20|Originality                  |9.70e-01 |


#### Red de Ocupaciones:

#### Top 20 Ocupaciones por Fuerza (Grado Ponderado igraph)


| Rank|Nombre                                               |Valor    |
|----:|:----------------------------------------------------|:--------|
|    1|Gambling Cage Workers                                |2.21e+02 |
|    2|Accountants and Auditors                             |2.19e+02 |
|    3|First-Line Supervisors of Non-Retail Sales Workers   |2.19e+02 |
|    4|Production, Planning, and Expediting Clerks          |2.18e+02 |
|    5|Personal Financial Advisors                          |2.18e+02 |
|    6|Dermatologists                                       |2.18e+02 |
|    7|Financial Managers                                   |2.17e+02 |
|    8|Document Management Specialists                      |2.17e+02 |
|    9|Ophthalmic Medical Technicians                       |2.17e+02 |
|   10|Labor Relations Specialists                          |2.17e+02 |
|   11|Industrial-Organizational Psychologists              |2.17e+02 |
|   12|Customer Service Representatives                     |2.17e+02 |
|   13|Ophthalmic Medical Technologists                     |2.17e+02 |
|   14|Court, Municipal, and License Clerks                 |2.17e+02 |
|   15|Compensation, Benefits, and Job Analysis Specialists |2.17e+02 |
|   16|Medical Dosimetrists                                 |2.17e+02 |
|   17|Training and Development Managers                    |2.17e+02 |
|   18|Speech-Language Pathology Assistants                 |2.16e+02 |
|   19|Treasurers and Controllers                           |2.16e+02 |
|   20|Tax Preparers                                        |2.16e+02 |


(No hay datos de centralidad Grado Generalizado (Opsahl α=0.5) para Ocupaciones)

#### Top 20 Ocupaciones por Intermediación Ponderada (igraph, 1/peso)


| Rank|Nombre                                                        |Valor    |
|----:|:-------------------------------------------------------------|:--------|
|    1|Chemical Technicians                                          |1.37e-02 |
|    2|Forensic Science Technicians                                  |1.07e-02 |
|    3|First-Line Supervisors of Housekeeping and Janitorial Workers |7.94e-03 |
|    4|Tailors, Dressmakers, and Custom Sewers                       |6.85e-03 |
|    5|Quality Control Analysts                                      |6.64e-03 |
|    6|Nanotechnology Engineering Technologists and Technicians      |6.15e-03 |
|    7|Dental Hygienists                                             |4.98e-03 |
|    8|Amusement and Recreation Attendants                           |4.48e-03 |
|    9|Driver/Sales Workers                                          |4.42e-03 |
|   10|Parts Salespersons                                            |4.34e-03 |
|   11|Transportation Inspectors                                     |4.34e-03 |
|   12|Gambling Cage Workers                                         |4.18e-03 |
|   13|Motion Picture Projectionists                                 |3.83e-03 |
|   14|Fuel Cell Engineers                                           |3.64e-03 |
|   15|Cashiers                                                      |3.54e-03 |
|   16|Umpires, Referees, and Other Sports Officials                 |3.49e-03 |
|   17|Bailiffs                                                      |3.24e-03 |
|   18|Psychiatric Aides                                             |3.17e-03 |
|   19|Histotechnologists                                            |2.90e-03 |
|   20|Food Science Technicians                                      |2.78e-03 |


#### Top 20 Ocupaciones por Intermediación Topológica (igraph, sin peso)


| Rank|Nombre                                                              |Valor    |
|----:|:-------------------------------------------------------------------|:--------|
|    1|Farmworkers and Laborers, Crop, Nursery, and Greenhouse             |3.55e-01 |
|    2|Judicial Law Clerks                                                 |8.62e-02 |
|    3|Mathematicians                                                      |4.21e-02 |
|    4|Compensation and Benefits Managers                                  |3.54e-02 |
|    5|Marriage and Family Therapists                                      |3.34e-02 |
|    6|Signal and Track Switch Repairers                                   |2.76e-02 |
|    7|Public Relations Specialists                                        |2.47e-02 |
|    8|Clinical and Counseling Psychologists                               |2.37e-02 |
|    9|Industrial Machinery Mechanics                                      |2.17e-02 |
|   10|Ship Engineers                                                      |1.85e-02 |
|   11|Political Scientists                                                |1.71e-02 |
|   12|Photonics Technicians                                               |1.61e-02 |
|   13|Financial Quantitative Analysts                                     |1.60e-02 |
|   14|Biostatisticians                                                    |1.46e-02 |
|   15|Electrical and Electronic Engineering Technologists and Technicians |1.24e-02 |
|   16|Sociologists                                                        |1.18e-02 |
|   17|Plumbers, Pipefitters, and Steamfitters                             |1.10e-02 |
|   18|Loan Officers                                                       |9.92e-03 |
|   19|Railroad Brake, Signal, and Switch Operators and Locomotive Firers  |9.42e-03 |
|   20|Mental Health Counselors                                            |9.22e-03 |


#### Top 20 Ocupaciones por Vector Propio Ponderado (igraph)


| Rank|Nombre                                                    |Valor    |
|----:|:---------------------------------------------------------|:--------|
|    1|Accountants and Auditors                                  |1.00e+00 |
|    2|First-Line Supervisors of Non-Retail Sales Workers        |9.93e-01 |
|    3|Personal Financial Advisors                               |9.93e-01 |
|    4|Financial Managers                                        |9.91e-01 |
|    5|Industrial-Organizational Psychologists                   |9.91e-01 |
|    6|Labor Relations Specialists                               |9.89e-01 |
|    7|Compensation, Benefits, and Job Analysis Specialists      |9.89e-01 |
|    8|Gambling Cage Workers                                     |9.87e-01 |
|    9|Training and Development Managers                         |9.87e-01 |
|   10|Document Management Specialists                           |9.87e-01 |
|   11|Treasurers and Controllers                                |9.86e-01 |
|   12|Credit Counselors                                         |9.85e-01 |
|   13|Customer Service Representatives                          |9.85e-01 |
|   14|Dermatologists                                            |9.85e-01 |
|   15|Court, Municipal, and License Clerks                      |9.84e-01 |
|   16|Tax Preparers                                             |9.83e-01 |
|   17|Compensation and Benefits Managers                        |9.83e-01 |
|   18|Fundraisers                                               |9.83e-01 |
|   19|Lawyers                                                   |9.83e-01 |
|   20|Educational, Guidance, and Career Counselors and Advisors |9.82e-01 |</code></pre>
</div>
</div>
</section>
<section id="resumen-de-estadísticas-de-red-por-período-basado-en-nivel" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="resumen-de-estadísticas-de-red-por-período-basado-en-nivel"><span class="header-section-number">3.3</span> Resumen de Estadísticas de Red por Período (Basado en Nivel)</h2>
<div class="cell">
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (Código igual que antes para crear y mostrar summary_table_level_formatted)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>summary_table_level <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(); <span class="cf">for</span> (period <span class="cf">in</span> periods) { stats_period <span class="ot">&lt;-</span> all_stats_level[[period]]; sk_stats <span class="ot">&lt;-</span> stats_period<span class="sc">$</span>skill_network <span class="sc">%||%</span> <span class="fu">calculate_network_stats_extended</span>(<span class="cn">NULL</span>); oc_stats <span class="ot">&lt;-</span> stats_period<span class="sc">$</span>occupation_network <span class="sc">%||%</span> <span class="fu">calculate_network_stats_extended</span>(<span class="cn">NULL</span>); summary_table_level <span class="ot">&lt;-</span> <span class="fu">rbind</span>(summary_table_level, <span class="fu">data.frame</span>( <span class="at">Periodo =</span> period, <span class="at">TipoRed =</span> <span class="st">"Habilidades (Compl. - Nivel)"</span>, <span class="at">Nodos =</span> sk_stats<span class="sc">$</span>num_nodes, <span class="at">Enlaces =</span> sk_stats<span class="sc">$</span>num_edges, <span class="at">Densidad =</span> sk_stats<span class="sc">$</span>density, <span class="at">Componentes =</span> sk_stats<span class="sc">$</span>components, <span class="at">PropCompGigante =</span> sk_stats<span class="sc">$</span>giant_component_prop, <span class="at">GradoMedio =</span> sk_stats<span class="sc">$</span>avg_degree, <span class="at">Transitividad =</span> sk_stats<span class="sc">$</span>transitivity, <span class="at">LongMediaCamino =</span> sk_stats<span class="sc">$</span>avg_path_length, <span class="at">Modularidad =</span> sk_stats<span class="sc">$</span>modularity, <span class="at">NumComunidades =</span> sk_stats<span class="sc">$</span>num_communities, <span class="at">CentralizacionGrado =</span> sk_stats<span class="sc">$</span>degree_centralization )); summary_table_level <span class="ot">&lt;-</span> <span class="fu">rbind</span>(summary_table_level, <span class="fu">data.frame</span>( <span class="at">Periodo =</span> period, <span class="at">TipoRed =</span> <span class="st">"Ocupaciones (Simil. - Nivel)"</span>, <span class="at">Nodos =</span> oc_stats<span class="sc">$</span>num_nodes, <span class="at">Enlaces =</span> oc_stats<span class="sc">$</span>num_edges, <span class="at">Densidad =</span> oc_stats<span class="sc">$</span>density, <span class="at">Componentes =</span> oc_stats<span class="sc">$</span>components, <span class="at">PropCompGigante =</span> oc_stats<span class="sc">$</span>giant_component_prop, <span class="at">GradoMedio =</span> oc_stats<span class="sc">$</span>avg_degree, <span class="at">Transitividad =</span> oc_stats<span class="sc">$</span>transitivity, <span class="at">LongMediaCamino =</span> oc_stats<span class="sc">$</span>avg_path_length, <span class="at">Modularidad =</span> oc_stats<span class="sc">$</span>modularity, <span class="at">NumComunidades =</span> oc_stats<span class="sc">$</span>num_communities, <span class="at">CentralizacionGrado =</span> oc_stats<span class="sc">$</span>degree_centralization ))}</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>format_num <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">digits =</span> <span class="dv">3</span>) {<span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="st">"NA"</span>, <span class="fu">ifelse</span>(<span class="fu">abs</span>(x) <span class="sc">&lt;</span> <span class="fl">1e-4</span> <span class="sc">&amp;</span> x <span class="sc">!=</span> <span class="dv">0</span>, <span class="fu">formatC</span>(x, <span class="at">format =</span> <span class="st">"e"</span>, <span class="at">digits =</span> digits <span class="sc">-</span> <span class="dv">1</span>), <span class="fu">formatC</span>(<span class="fu">round</span>(x, digits), <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> digits, <span class="at">big.mark =</span> <span class="st">","</span>)))}</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>summary_table_level_formatted <span class="ot">&lt;-</span> summary_table_level <span class="sc">%&gt;%</span> <span class="fu">mutate</span>( <span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">format_num</span>(., <span class="dv">3</span>))) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>( <span class="at">Nodos =</span> scales<span class="sc">::</span><span class="fu">comma</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>,<span class="st">""</span>,Nodos)), <span class="at">accuracy=</span><span class="dv">1</span>), <span class="at">Enlaces =</span> scales<span class="sc">::</span><span class="fu">comma</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>,<span class="st">""</span>,Enlaces)), <span class="at">accuracy=</span><span class="dv">1</span>), <span class="at">Componentes =</span> <span class="fu">ifelse</span>(Componentes<span class="sc">==</span><span class="st">"NA"</span>, <span class="st">"NA"</span>, scales<span class="sc">::</span><span class="fu">comma</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>,<span class="st">""</span>,Componentes)), <span class="at">accuracy=</span><span class="dv">1</span>)), <span class="at">NumComunidades =</span> <span class="fu">ifelse</span>(NumComunidades<span class="sc">==</span><span class="st">"NA"</span>, <span class="st">"NA"</span>, scales<span class="sc">::</span><span class="fu">comma</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>,<span class="st">""</span>,NumComunidades)), <span class="at">accuracy=</span><span class="dv">1</span>)), <span class="at">Densidad =</span> <span class="fu">format_num</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>,<span class="st">""</span>,Densidad)), <span class="dv">4</span>), <span class="at">Modularidad =</span> <span class="fu">format_num</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>,<span class="st">""</span>,Modularidad)), <span class="dv">4</span>), <span class="at">CentralizacionGrado =</span> <span class="fu">format_num</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>,<span class="st">""</span>,CentralizacionGrado)), <span class="dv">4</span>) ) </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(summary_table_level_formatted, <span class="at">caption =</span> <span class="st">"Estadísticas Descriptivas y Estructurales de las Redes (Basadas en Nivel) por Período"</span>, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Período"</span>, <span class="st">"Tipo Red"</span>, <span class="st">"Nodos"</span>, <span class="st">"Enlaces"</span>, <span class="st">"Densidad"</span>, <span class="st">"Comp."</span>, <span class="st">"Prop. Comp. Gig."</span>, <span class="st">"Grado Medio"</span>, <span class="st">"Transitividad"</span>, <span class="st">"Long. Camino"</span>, <span class="st">"Modularidad"</span>, <span class="st">"Nº Comunid."</span>, <span class="st">"Centr. Grado"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Estadísticas Descriptivas y Estructurales de las Redes (Basadas en Nivel) por Período</caption>
<colgroup>
<col style="width: 6%">
<col style="width: 18%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Período</th>
<th style="text-align: left;">Tipo Red</th>
<th style="text-align: left;">Nodos</th>
<th style="text-align: left;">Enlaces</th>
<th style="text-align: left;">Densidad</th>
<th style="text-align: left;">Comp.</th>
<th style="text-align: left;">Prop. Comp. Gig.</th>
<th style="text-align: left;">Grado Medio</th>
<th style="text-align: left;">Transitividad</th>
<th style="text-align: left;">Long. Camino</th>
<th style="text-align: left;">Modularidad</th>
<th style="text-align: left;">Nº Comunid.</th>
<th style="text-align: left;">Centr. Grado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2005-2009</td>
<td style="text-align: left;">Habilidades (Compl. - Nivel)</td>
<td style="text-align: left;">126</td>
<td style="text-align: left;">7,850</td>
<td style="text-align: left;">0.9970</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">124.603</td>
<td style="text-align: left;">0.997</td>
<td style="text-align: left;">0.270</td>
<td style="text-align: left;">0.0620</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">0.0030</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005-2009</td>
<td style="text-align: left;">Ocupaciones (Simil. - Nivel)</td>
<td style="text-align: left;">20</td>
<td style="text-align: left;">190</td>
<td style="text-align: left;">1.0000</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">19.000</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">0.452</td>
<td style="text-align: left;">0.0270</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2010-2014</td>
<td style="text-align: left;">Habilidades (Compl. - Nivel)</td>
<td style="text-align: left;">161</td>
<td style="text-align: left;">12,733</td>
<td style="text-align: left;">0.9890</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">158.174</td>
<td style="text-align: left;">0.990</td>
<td style="text-align: left;">0.116</td>
<td style="text-align: left;">0.1230</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">0.0110</td>
</tr>
<tr class="even">
<td style="text-align: left;">2010-2014</td>
<td style="text-align: left;">Ocupaciones (Simil. - Nivel)</td>
<td style="text-align: left;">89</td>
<td style="text-align: left;">3,839</td>
<td style="text-align: left;">0.9800</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">86.270</td>
<td style="text-align: left;">0.984</td>
<td style="text-align: left;">0.123</td>
<td style="text-align: left;">0.2040</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">0.0200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2015-2019</td>
<td style="text-align: left;">Habilidades (Compl. - Nivel)</td>
<td style="text-align: left;">161</td>
<td style="text-align: left;">12,880</td>
<td style="text-align: left;">1.0000</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">160.000</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">0.240</td>
<td style="text-align: left;">0.1640</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">2015-2019</td>
<td style="text-align: left;">Ocupaciones (Simil. - Nivel)</td>
<td style="text-align: left;">332</td>
<td style="text-align: left;">54,940</td>
<td style="text-align: left;">1.0000</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">330.964</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">0.279</td>
<td style="text-align: left;">0.1820</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2020-2024</td>
<td style="text-align: left;">Habilidades (Compl. - Nivel)</td>
<td style="text-align: left;">161</td>
<td style="text-align: left;">12,880</td>
<td style="text-align: left;">1.0000</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">160.000</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">0.239</td>
<td style="text-align: left;">0.1350</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">2020-2024</td>
<td style="text-align: left;">Ocupaciones (Simil. - Nivel)</td>
<td style="text-align: left;">458</td>
<td style="text-align: left;">104,653</td>
<td style="text-align: left;">1.0000</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">457.000</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">0.290</td>
<td style="text-align: left;">0.1420</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">0.0000</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="evolución-temporal-de-métricas-de-red" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="evolución-temporal-de-métricas-de-red"><span class="header-section-number">3.4</span> Evolución Temporal de Métricas de Red</h2>
<div class="cell">
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (Código igual que antes para crear el gráfico con ggplot2)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> summary_table_level <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Nodos, Enlaces, Densidad, PropCompGigante, GradoMedio, Transitividad, Modularidad, NumComunidades, CentralizacionGrado), <span class="sc">~</span><span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, .))))) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Periodo, TipoRed, Nodos, Enlaces, Densidad, Modularidad, NumComunidades, CentralizacionGrado) <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(Periodo, TipoRed), <span class="at">names_to =</span> <span class="st">"Metrica"</span>, <span class="at">values_to =</span> <span class="st">"Valor"</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Periodo =</span> <span class="fu">factor</span>(Periodo, <span class="at">levels =</span> periods), <span class="at">TipoRed =</span> <span class="fu">factor</span>(TipoRed)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Valor)) </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>metrics_to_plot <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Nodos"</span>, <span class="st">"Enlaces"</span>, <span class="st">"Densidad"</span>, <span class="st">"Modularidad"</span>, <span class="st">"NumComunidades"</span>, <span class="st">"CentralizacionGrado"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>plot_data_filtered <span class="ot">&lt;-</span> plot_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Metrica <span class="sc">%in%</span> metrics_to_plot)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data_filtered, <span class="fu">aes</span>(<span class="at">x =</span> Periodo, <span class="at">y =</span> Valor, <span class="at">group =</span> TipoRed, <span class="at">color =</span> TipoRed, <span class="at">linetype =</span> TipoRed, <span class="at">shape =</span> TipoRed)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Metrica, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>, <span class="at">name =</span> <span class="st">"Tipo de Red"</span>) <span class="sc">+</span> <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Tipo de Red"</span>) <span class="sc">+</span> <span class="fu">scale_shape_discrete</span>(<span class="at">name =</span> <span class="st">"Tipo de Red"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Evolución Temporal de Métricas Clave de las Redes (Basadas en Nivel)"</span>, <span class="at">x =</span> <span class="st">"Período"</span>, <span class="at">y =</span> <span class="st">"Valor de la Métrica"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>), <span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>), <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="00_descriptives_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="backbone" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="backbone"><span class="header-section-number">3.5</span> Backbone</h2>
<div class="cell">
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("backbone") # Instalar el paquete backbone si no está instalado</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(backbone)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Sección de Análisis de Backbone (Modificada para Excluir Nodos Aislados de las Tablas) ---</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Objetivo: Extraer la estructura más significativa (backbone) y analizar la centralidad</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># de los nodos CONECTADOS dentro de esa estructura.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Método Elegido: Filtro de Disparidad (disparity filter).</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Justificación: Adecuado para redes ponderadas, identifica enlaces estadísticamente</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># significativos localmente.</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Usaremos el último período para este análisis detallado</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>last_period <span class="ot">&lt;-</span> periods[<span class="fu">length</span>(periods)]</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">### Análisis de Backbone y su Centralidad (Período: "</span>, last_period, <span class="st">") - Solo Nodos Conectados en Tablas</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
### Análisis de Backbone y su Centralidad (Período: 2020-2024) - Solo Nodos Conectados en Tablas</code></pre>
</div>
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 1. Recargar/Recrear Grafos del Último Período ---</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (Esta parte del código es igual a la anterior para cargar los grafos skill_graph_last y occ_graph_last)</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">**1. Preparando Grafos del Período "</span>, last_period, <span class="st">"**</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
**1. Preparando Grafos del Período 2020-2024**</code></pre>
</div>
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>skill_graph_last <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>occ_graph_last <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>skill_pairs_last <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>occ_pairs_last <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>skill_names_map_last <span class="ot">&lt;-</span> <span class="fu">data.table</span>() <span class="co"># Mapa específico para este período si fuera necesario</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Recargar datos de pares de habilidades del último período</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>skill_file_last <span class="ot">&lt;-</span> <span class="fu">file.path</span>(skill_network_base_dir, last_period, <span class="st">"skill_pairs_level.csv"</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>skill_pairs_last <span class="ot">&lt;-</span> <span class="fu">read_exported_csv</span>(skill_file_last)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(skill_pairs_last) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(skill_pairs_last) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    skill_pairs_last[, skill1 <span class="sc">:</span><span class="er">=</span> <span class="fu">trimws</span>(<span class="fu">as.character</span>(skill1))]</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    skill_pairs_last[, skill2 <span class="sc">:</span><span class="er">=</span> <span class="fu">trimws</span>(<span class="fu">as.character</span>(skill2))]</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    skill_pairs_last <span class="ot">&lt;-</span> skill_pairs_last[<span class="sc">!</span><span class="fu">is.na</span>(skill1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(skill2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(weight) <span class="sc">&amp;</span> weight <span class="sc">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">nrow</span>(skill_pairs_last) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        all_skill_nodes_last <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(skill_pairs_last<span class="sc">$</span>skill1, skill_pairs_last<span class="sc">$</span>skill2))</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"skill_names_map"</span>) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(skill_names_map) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>             skill_names_map_last <span class="ot">&lt;-</span> skill_names_map</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>         } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"name1"</span>, <span class="st">"name2"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(skill_pairs_last))) {</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>            skill_names_map_last <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">rbind</span>(skill_pairs_last[, .(<span class="at">id =</span> skill1, <span class="at">name =</span> name1)], skill_pairs_last[, .(<span class="at">id =</span> skill2, <span class="at">name =</span> name2)]))</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>            skill_names_map_last <span class="ot">&lt;-</span> skill_names_map_last[<span class="sc">!</span><span class="fu">is.na</span>(id) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(name)]</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">setkey</span>(skill_names_map_last, id)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>         } <span class="cf">else</span> {</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>             <span class="fu">cat</span>(<span class="st">"Advertencia: No se pudo crear mapa de nombres de habilidades para el backbone.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>             skill_names_map_last <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">id=</span><span class="fu">character</span>(), <span class="at">name=</span><span class="fu">character</span>())</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>         }</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>        skill_graph_last <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({ <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> skill_pairs_last[, .(skill1, skill2, weight)], <span class="at">directed =</span> <span class="cn">FALSE</span>, <span class="at">vertices =</span> <span class="fu">data.frame</span>(<span class="at">name =</span> all_skill_nodes_last)) }, <span class="at">error=</span><span class="cf">function</span>(e) { <span class="fu">warning</span>(<span class="st">"Error creando grafo hab (Nivel) para backbone: "</span>, e<span class="sc">$</span>message); <span class="cn">NULL</span> })</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(skill_graph_last)) { skill_graph_last <span class="ot">&lt;-</span> <span class="fu">simplify</span>(skill_graph_last, <span class="at">remove.multiple =</span> <span class="cn">TRUE</span>, <span class="at">remove.loops =</span> <span class="cn">TRUE</span>, <span class="at">edge.attr.comb =</span> <span class="st">"mean"</span>); <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"* Grafo Hab (Nivel, %s): %d nodos, %d enlaces listos para backbone.</span><span class="sc">\n</span><span class="st">"</span>, last_period, <span class="fu">vcount</span>(skill_graph_last), <span class="fu">ecount</span>(skill_graph_last))) } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"* No se pudo crear grafo de habilidades para backbone ("</span>, last_period, <span class="st">").</span><span class="sc">\n</span><span class="st">"</span>)) }</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"* No hay pares de habilidades válidos para backbone ("</span>, last_period, <span class="st">").</span><span class="sc">\n</span><span class="st">"</span>)) }</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> { <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"* No se encontraron datos de pares de habilidades para backbone ("</span>, last_period, <span class="st">").</span><span class="sc">\n</span><span class="st">"</span>)) }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>* Grafo Hab (Nivel, 2020-2024): 161 nodos, 12880 enlaces listos para backbone.</code></pre>
</div>
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recargar datos de pares de ocupaciones del último período</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>occ_file_last <span class="ot">&lt;-</span> <span class="fu">file.path</span>(occupation_network_base_dir, last_period, <span class="st">"occupation_pairs_level.csv"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>occ_pairs_last <span class="ot">&lt;-</span> <span class="fu">read_exported_csv</span>(occ_file_last)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(occ_pairs_last) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(occ_pairs_last) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    occ_pairs_last[, occupation1 <span class="sc">:</span><span class="er">=</span> <span class="fu">trimws</span>(<span class="fu">as.character</span>(occupation1))]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    occ_pairs_last[, occupation2 <span class="sc">:</span><span class="er">=</span> <span class="fu">trimws</span>(<span class="fu">as.character</span>(occupation2))]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    occ_pairs_last <span class="ot">&lt;-</span> occ_pairs_last[<span class="sc">!</span><span class="fu">is.na</span>(occupation1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(occupation2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(weight) <span class="sc">&amp;</span> weight <span class="sc">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">nrow</span>(occ_pairs_last) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>        all_occ_nodes_last <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(occ_pairs_last<span class="sc">$</span>occupation1, occ_pairs_last<span class="sc">$</span>occupation2))</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>        occ_graph_last <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({ <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> occ_pairs_last[, .(occupation1, occupation2, weight)], <span class="at">directed =</span> <span class="cn">FALSE</span>, <span class="at">vertices =</span> <span class="fu">data.frame</span>(<span class="at">name =</span> all_occ_nodes_last)) }, <span class="at">error=</span><span class="cf">function</span>(e) { <span class="fu">warning</span>(<span class="st">"Error creando grafo occ (Nivel) para backbone: "</span>, e<span class="sc">$</span>message); <span class="cn">NULL</span> })</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(occ_graph_last)) { occ_graph_last <span class="ot">&lt;-</span> <span class="fu">simplify</span>(occ_graph_last, <span class="at">remove.multiple =</span> <span class="cn">TRUE</span>, <span class="at">remove.loops =</span> <span class="cn">TRUE</span>, <span class="at">edge.attr.comb =</span> <span class="st">"mean"</span>); <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"* Grafo Occ (Nivel, %s): %d nodos, %d enlaces listos para backbone.</span><span class="sc">\n</span><span class="st">"</span>, last_period, <span class="fu">vcount</span>(occ_graph_last), <span class="fu">ecount</span>(occ_graph_last))) } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"* No se pudo crear grafo de ocupaciones para backbone ("</span>, last_period, <span class="st">").</span><span class="sc">\n</span><span class="st">"</span>)) }</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"* No hay pares de ocupaciones válidos para backbone ("</span>, last_period, <span class="st">").</span><span class="sc">\n</span><span class="st">"</span>)) }</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> { <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"* No se encontraron datos de pares de ocupaciones para backbone ("</span>, last_period, <span class="st">").</span><span class="sc">\n</span><span class="st">"</span>)) }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>* Grafo Occ (Nivel, 2020-2024): 458 nodos, 104653 enlaces listos para backbone.</code></pre>
</div>
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2. Extracción del Backbone y Análisis de Centralidad (Filtrado) ---</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">**2. Extracción de Backbone y Análisis de Centralidad (Filtrando Nodos Aislados)**</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
**2. Extracción de Backbone y Análisis de Centralidad (Filtrando Nodos Aislados)**</code></pre>
</div>
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2.1 Backbone y Centralidad Red Habilidades ---</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">#### Red de Habilidades</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
#### Red de Habilidades</code></pre>
</div>
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>bb_skill <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(skill_graph_last) <span class="sc">&amp;&amp;</span> <span class="fu">ecount</span>(skill_graph_last) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parámetro Alpha (ajusta según necesidad)</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    alpha_threshold_skill <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># Ejemplo, usa el valor que te funcione mejor</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Extrayendo Backbone de Habilidades (Disparity Filter, alpha = "</span>, alpha_threshold_skill, <span class="st">")...</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    bb_skill <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({ backbone<span class="sc">::</span><span class="fu">disparity</span>(skill_graph_last, <span class="at">alpha =</span> alpha_threshold_skill, <span class="at">class =</span> <span class="st">"igraph"</span>, <span class="at">narrative =</span> <span class="cn">TRUE</span>) }, <span class="at">error =</span> <span class="cf">function</span>(e) { <span class="fu">cat</span>(<span class="st">"Error extrayendo backbone de habilidades (Disparity Filter):"</span>, e<span class="sc">$</span>message, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>); <span class="cn">NULL</span> })</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(bb_skill) <span class="sc">&amp;&amp;</span> <span class="fu">vcount</span>(bb_skill) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">ecount</span>(bb_skill) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>        prop_edges_kept <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">ecount</span>(skill_graph_last) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">100</span> <span class="sc">*</span> <span class="fu">ecount</span>(bb_skill) <span class="sc">/</span> <span class="fu">ecount</span>(skill_graph_last), <span class="dv">0</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">* Backbone Habilidades (Disparity α=%.2f): %d nodos, %d enlaces significativos (%.2f%% del original).</span><span class="sc">\n</span><span class="st">"</span>, alpha_threshold_skill, <span class="fu">vcount</span>(bb_skill), <span class="fu">ecount</span>(bb_skill), prop_edges_kept))</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># --- Calcular Centralidad y Filtrar Nodos Aislados ---</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Calculando Centralidad (No Ponderada) en Backbone de Habilidades y Filtrando Nodos Aislados...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># PASO CLAVE: Calcular grados en el backbone e identificar nodos conectados</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>        deg_bb_sk_raw <span class="ot">&lt;-</span> <span class="fu">degree</span>(bb_skill, <span class="at">mode =</span> <span class="st">"all"</span>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>        connected_nodes_sk_ids <span class="ot">&lt;-</span> <span class="fu">names</span>(deg_bb_sk_raw[deg_bb_sk_raw <span class="sc">&gt;</span> <span class="dv">0</span>])</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Filtrar si hay nodos conectados</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(connected_nodes_sk_ids) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Grado (Solo nodos conectados)</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>            deg_bb_sk_filtered <span class="ot">&lt;-</span> deg_bb_sk_raw[connected_nodes_sk_ids] <span class="co"># Ya tenemos los grados de los conectados</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>            cent_deg_bb_sk_df <span class="ot">&lt;-</span> <span class="fu">format_cent</span>(deg_bb_sk_filtered, skill_names_map_last)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">print_centrality_table</span>(cent_deg_bb_sk_df, <span class="st">"Grado (Backbone, Solo Conectados)"</span>, <span class="st">"Habilidades"</span>)</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Intermediación (Calculada para todos, filtrada para la tabla)</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>            bet_bb_sk_raw <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(<span class="fu">betweenness</span>(bb_skill, <span class="at">directed =</span> <span class="cn">FALSE</span>, <span class="at">weights =</span> <span class="cn">NULL</span>, <span class="at">normalized =</span> <span class="cn">TRUE</span>), <span class="at">error=</span><span class="cf">function</span>(e) {<span class="fu">warning</span>(<span class="st">"Betweenness (Backbone SK) falló: "</span>,e<span class="sc">$</span>message); <span class="cn">NULL</span>})</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(bet_bb_sk_raw)) {</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>                 bet_bb_sk_filtered <span class="ot">&lt;-</span> bet_bb_sk_raw[<span class="fu">names</span>(bet_bb_sk_raw) <span class="sc">%in%</span> connected_nodes_sk_ids]</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>                 cent_bet_bb_sk_df <span class="ot">&lt;-</span> <span class="fu">format_cent</span>(bet_bb_sk_filtered, skill_names_map_last)</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">print_centrality_table</span>(cent_bet_bb_sk_df, <span class="st">"Intermediación (Backbone, Solo Conectados)"</span>, <span class="st">"Habilidades"</span>)</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>            } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">(No se pudo calcular Intermediación para Habilidades en Backbone)</span><span class="sc">\n</span><span class="st">"</span>) }</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Vector Propio (Calculado en componente(s) relevante(s), filtrado para la tabla)</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>            eig_bb_sk_raw <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>            comp_bb_sk <span class="ot">&lt;-</span> <span class="fu">components</span>(bb_skill, <span class="at">mode=</span><span class="st">"weak"</span>)</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># ... (lógica anterior para calcular eig_bb_sk_raw en el componente gigante o grafo conectado) ...</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>             <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(comp_bb_sk<span class="sc">$</span>no) <span class="sc">&amp;&amp;</span> <span class="fu">vcount</span>(bb_skill)<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">ecount</span>(bb_skill)<span class="sc">&gt;</span><span class="dv">0</span>) {</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">if</span> (comp_bb_sk<span class="sc">$</span>no <span class="sc">==</span> <span class="dv">1</span>) { subgraph_bb_sk <span class="ot">&lt;-</span> bb_skill } <span class="cf">else</span> {</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>                     giant_nodes_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(comp_bb_sk<span class="sc">$</span>membership <span class="sc">==</span> <span class="fu">which.max</span>(comp_bb_sk<span class="sc">$</span>csize))</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">if</span> (<span class="fu">length</span>(giant_nodes_idx) <span class="sc">/</span> <span class="fu">vcount</span>(bb_skill) <span class="sc">&gt;</span> <span class="fl">0.5</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(giant_nodes_idx) <span class="sc">&gt;</span> <span class="dv">1</span>) { subgraph_bb_sk <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(bb_skill, giant_nodes_idx) } <span class="cf">else</span> { subgraph_bb_sk <span class="ot">&lt;-</span> <span class="cn">NULL</span> }</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>                 }</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(subgraph_bb_sk) <span class="sc">&amp;&amp;</span> <span class="fu">ecount</span>(subgraph_bb_sk) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>                     eig_calc <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(<span class="fu">eigen_centrality</span>(subgraph_bb_sk, <span class="at">directed=</span><span class="cn">FALSE</span>, <span class="at">scale=</span><span class="cn">TRUE</span>, <span class="at">weights=</span><span class="cn">NULL</span>)<span class="sc">$</span>vector, <span class="at">error=</span><span class="cf">function</span>(e) {<span class="fu">warning</span>(<span class="st">"Eigenvector (Backbone SK) falló: "</span>,e<span class="sc">$</span>message); <span class="cn">NULL</span>})</span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(eig_calc) <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(eig_calc)<span class="sc">&gt;</span><span class="dv">0</span>) { eig_bb_sk_raw <span class="ot">&lt;-</span> <span class="fu">setNames</span>(eig_calc, <span class="fu">V</span>(subgraph_bb_sk)<span class="sc">$</span>name) }</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>                 }</span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>             }</span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>            <span class="co">#-- Fin lógica cálculo eigenvector --</span></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(eig_bb_sk_raw)) {</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Asegurarse de que los nombres en eig_bb_sk_raw existen antes de filtrar</span></span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>                valid_eig_nodes <span class="ot">&lt;-</span> <span class="fu">names</span>(eig_bb_sk_raw)[<span class="fu">names</span>(eig_bb_sk_raw) <span class="sc">%in%</span> connected_nodes_sk_ids]</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="fu">length</span>(valid_eig_nodes) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>                   eig_bb_sk_filtered <span class="ot">&lt;-</span> eig_bb_sk_raw[valid_eig_nodes]</span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>                   cent_eig_bb_sk_df <span class="ot">&lt;-</span> <span class="fu">format_cent</span>(eig_bb_sk_filtered, skill_names_map_last)</span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">print_centrality_table</span>(cent_eig_bb_sk_df, <span class="st">"Vector Propio (Backbone, Solo Conectados)"</span>, <span class="st">"Habilidades"</span>)</span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>                } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">(Nodos conectados no encontrados en cálculo de Eigenvector para Habilidades en Backbone)</span><span class="sc">\n</span><span class="st">"</span>) }</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>            } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">(No se pudo calcular Vector Propio para Habilidades en Backbone)</span><span class="sc">\n</span><span class="st">"</span>) }</span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>             <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">No se encontraron nodos conectados en el backbone de habilidades para calcular centralidad.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"Backbone de habilidades no pudo ser extraído, está vacío o no tiene enlaces (alpha = "</span>, alpha_threshold_skill, <span class="st">").</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"--&gt; SUGERENCIA: Intenta AUMENTAR el valor de 'alpha_threshold_skill' (e.g., a 0.10 o 0.15) y vuelve a ejecutar.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"No se pudo crear el grafo de habilidades o no tiene enlaces para extraer el backbone.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Extrayendo Backbone de Habilidades (Disparity Filter, alpha = 0.1)...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
* Backbone Habilidades (Disparity α=0.10): 161 nodos, 19 enlaces significativos (0.15% del original).

Calculando Centralidad (No Ponderada) en Backbone de Habilidades y Filtrando Nodos Aislados...

#### Top 20 Habilidades por Grado (Backbone, Solo Conectados)


| Rank|Nombre                                               |Valor |
|----:|:----------------------------------------------------|:-----|
|    1|Night Vision                                         |5e+00 |
|    2|Peripheral Vision                                    |5e+00 |
|    3|Spatial Orientation                                  |4e+00 |
|    4|Glare Sensitivity                                    |4e+00 |
|    5|Sound Localization                                   |4e+00 |
|    6|Equipment Selection                                  |3e+00 |
|    7|Installation                                         |3e+00 |
|    8|Equipment Maintenance                                |3e+00 |
|    9|Repairing                                            |3e+00 |
|   10|Operating Vehicles, Mechanized Devices, or Equipment |2e+00 |
|   11|Speed of Limb Movement                               |1e+00 |
|   12|Dynamic Flexibility                                  |1e+00 |


#### Top 20 Habilidades por Intermediación (Backbone, Solo Conectados)


| Rank|Nombre                                               |Valor    |
|----:|:----------------------------------------------------|:--------|
|    1|Night Vision                                         |1.18e-04 |
|    2|Peripheral Vision                                    |1.18e-04 |
|    3|Spatial Orientation                                  |0.00e+00 |
|    4|Speed of Limb Movement                               |0.00e+00 |
|    5|Dynamic Flexibility                                  |0.00e+00 |
|    6|Glare Sensitivity                                    |0.00e+00 |
|    7|Sound Localization                                   |0.00e+00 |
|    8|Equipment Selection                                  |0.00e+00 |
|    9|Installation                                         |0.00e+00 |
|   10|Equipment Maintenance                                |0.00e+00 |
|   11|Repairing                                            |0.00e+00 |
|   12|Operating Vehicles, Mechanized Devices, or Equipment |0.00e+00 |


(No se pudo calcular Vector Propio para Habilidades en Backbone)</code></pre>
</div>
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2.2 Backbone y Centralidad Red Ocupaciones ---</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">#### Red de Ocupaciones</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
#### Red de Ocupaciones</code></pre>
</div>
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>bb_occ <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(occ_graph_last) <span class="sc">&amp;&amp;</span> <span class="fu">ecount</span>(occ_graph_last) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parámetro Alpha (ajusta según necesidad)</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    alpha_threshold_occ <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># Ejemplo, usa el valor que te funcione mejor</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Extrayendo Backbone de Ocupaciones (Disparity Filter, alpha = "</span>, alpha_threshold_occ, <span class="st">")...</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    bb_occ <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({ backbone<span class="sc">::</span><span class="fu">disparity</span>(occ_graph_last, <span class="at">alpha =</span> alpha_threshold_occ, <span class="at">class =</span> <span class="st">"igraph"</span>, <span class="at">narrative =</span> <span class="cn">TRUE</span>) }, <span class="at">error =</span> <span class="cf">function</span>(e) { <span class="fu">cat</span>(<span class="st">"Error extrayendo backbone de ocupaciones (Disparity Filter):"</span>, e<span class="sc">$</span>message, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>); <span class="cn">NULL</span> })</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(bb_occ) <span class="sc">&amp;&amp;</span> <span class="fu">vcount</span>(bb_occ) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">ecount</span>(bb_occ) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>        prop_edges_kept_occ <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">ecount</span>(occ_graph_last) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">100</span> <span class="sc">*</span> <span class="fu">ecount</span>(bb_occ) <span class="sc">/</span> <span class="fu">ecount</span>(occ_graph_last), <span class="dv">0</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">* Backbone Ocupaciones (Disparity α=%.2f): %d nodos, %d enlaces significativos (%.2f%% del original).</span><span class="sc">\n</span><span class="st">"</span>, alpha_threshold_occ, <span class="fu">vcount</span>(bb_occ), <span class="fu">ecount</span>(bb_occ), prop_edges_kept_occ))</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># --- Calcular Centralidad y Filtrar Nodos Aislados ---</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Calculando Centralidad (No Ponderada) en Backbone de Ocupaciones y Filtrando Nodos Aislados...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># PASO CLAVE: Calcular grados en el backbone e identificar nodos conectados</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        deg_bb_oc_raw <span class="ot">&lt;-</span> <span class="fu">degree</span>(bb_occ, <span class="at">mode =</span> <span class="st">"all"</span>)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>        connected_nodes_oc_ids <span class="ot">&lt;-</span> <span class="fu">names</span>(deg_bb_oc_raw[deg_bb_oc_raw <span class="sc">&gt;</span> <span class="dv">0</span>])</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Filtrar si hay nodos conectados</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(connected_nodes_oc_ids) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Grado (Solo nodos conectados)</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>            deg_bb_oc_filtered <span class="ot">&lt;-</span> deg_bb_oc_raw[connected_nodes_oc_ids]</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>            cent_deg_bb_oc_df <span class="ot">&lt;-</span> <span class="fu">format_cent_occ</span>(deg_bb_oc_filtered, occupation_titles_df)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">print_centrality_table</span>(cent_deg_bb_oc_df, <span class="st">"Grado (Backbone, Solo Conectados)"</span>, <span class="st">"Ocupaciones"</span>)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Intermediación (Calculada para todos, filtrada para la tabla)</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>            bet_bb_oc_raw <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(<span class="fu">betweenness</span>(bb_occ, <span class="at">directed =</span> <span class="cn">FALSE</span>, <span class="at">weights =</span> <span class="cn">NULL</span>, <span class="at">normalized =</span> <span class="cn">TRUE</span>), <span class="at">error=</span><span class="cf">function</span>(e) {<span class="fu">warning</span>(<span class="st">"Betweenness (Backbone OC) falló: "</span>,e<span class="sc">$</span>message); <span class="cn">NULL</span>})</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>             <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(bet_bb_oc_raw)) {</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>                 bet_bb_oc_filtered <span class="ot">&lt;-</span> bet_bb_oc_raw[<span class="fu">names</span>(bet_bb_oc_raw) <span class="sc">%in%</span> connected_nodes_oc_ids]</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>                 cent_bet_bb_oc_df <span class="ot">&lt;-</span> <span class="fu">format_cent_occ</span>(bet_bb_oc_filtered, occupation_titles_df)</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">print_centrality_table</span>(cent_bet_bb_oc_df, <span class="st">"Intermediación (Backbone, Solo Conectados)"</span>, <span class="st">"Ocupaciones"</span>)</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>             } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">(No se pudo calcular Intermediación para Ocupaciones en Backbone)</span><span class="sc">\n</span><span class="st">"</span>) }</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Vector Propio (Calculado en componente(s) relevante(s), filtrado para la tabla)</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>            eig_bb_oc_raw <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>            comp_bb_oc <span class="ot">&lt;-</span> <span class="fu">components</span>(bb_occ, <span class="at">mode=</span><span class="st">"weak"</span>)</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># ... (lógica anterior para calcular eig_bb_oc_raw en el componente gigante o grafo conectado) ...</span></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>             <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(comp_bb_oc<span class="sc">$</span>no) <span class="sc">&amp;&amp;</span> <span class="fu">vcount</span>(bb_occ)<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">ecount</span>(bb_occ)<span class="sc">&gt;</span><span class="dv">0</span>) {</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">if</span> (comp_bb_oc<span class="sc">$</span>no <span class="sc">==</span> <span class="dv">1</span>) { subgraph_bb_oc <span class="ot">&lt;-</span> bb_occ } <span class="cf">else</span> {</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>                     giant_nodes_idx_oc <span class="ot">&lt;-</span> <span class="fu">which</span>(comp_bb_oc<span class="sc">$</span>membership <span class="sc">==</span> <span class="fu">which.max</span>(comp_bb_oc<span class="sc">$</span>csize))</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">if</span> (<span class="fu">length</span>(giant_nodes_idx_oc) <span class="sc">/</span> <span class="fu">vcount</span>(bb_occ) <span class="sc">&gt;</span> <span class="fl">0.5</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(giant_nodes_idx_oc) <span class="sc">&gt;</span> <span class="dv">1</span>) { subgraph_bb_oc <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(bb_occ, giant_nodes_idx_oc) } <span class="cf">else</span> { subgraph_bb_oc <span class="ot">&lt;-</span> <span class="cn">NULL</span> }</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>                 }</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>                  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(subgraph_bb_oc) <span class="sc">&amp;&amp;</span> <span class="fu">ecount</span>(subgraph_bb_oc) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>                     eig_calc_oc <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(<span class="fu">eigen_centrality</span>(subgraph_bb_oc, <span class="at">directed=</span><span class="cn">FALSE</span>, <span class="at">scale=</span><span class="cn">TRUE</span>, <span class="at">weights=</span><span class="cn">NULL</span>)<span class="sc">$</span>vector, <span class="at">error=</span><span class="cf">function</span>(e) {<span class="fu">warning</span>(<span class="st">"Eigenvector (Backbone OC) falló: "</span>,e<span class="sc">$</span>message); <span class="cn">NULL</span>})</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(eig_calc_oc) <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(eig_calc_oc)<span class="sc">&gt;</span><span class="dv">0</span>) { eig_bb_oc_raw <span class="ot">&lt;-</span> <span class="fu">setNames</span>(eig_calc_oc, <span class="fu">V</span>(subgraph_bb_oc)<span class="sc">$</span>name) }</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>                 }</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>             }</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>            <span class="co">#-- Fin lógica cálculo eigenvector --</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(eig_bb_oc_raw)) {</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>                 valid_eig_nodes_oc <span class="ot">&lt;-</span> <span class="fu">names</span>(eig_bb_oc_raw)[<span class="fu">names</span>(eig_bb_oc_raw) <span class="sc">%in%</span> connected_nodes_oc_ids]</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">if</span> (<span class="fu">length</span>(valid_eig_nodes_oc) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>                    eig_bb_oc_filtered <span class="ot">&lt;-</span> eig_bb_oc_raw[valid_eig_nodes_oc]</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>                    cent_eig_bb_oc_df <span class="ot">&lt;-</span> <span class="fu">format_cent_occ</span>(eig_bb_oc_filtered, occupation_titles_df)</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">print_centrality_table</span>(cent_eig_bb_oc_df, <span class="st">"Vector Propio (Backbone, Solo Conectados)"</span>, <span class="st">"Ocupaciones"</span>)</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>                 } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">(Nodos conectados no encontrados en cálculo de Eigenvector para Ocupaciones en Backbone)</span><span class="sc">\n</span><span class="st">"</span>) }</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>            } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">(No se pudo calcular Vector Propio para Ocupaciones en Backbone)</span><span class="sc">\n</span><span class="st">"</span>) }</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">No se encontraron nodos conectados en el backbone de ocupaciones para calcular centralidad.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a>         <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"Backbone de ocupaciones no pudo ser extraído, está vacío o no tiene enlaces (alpha = "</span>, alpha_threshold_occ, <span class="st">").</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a>         <span class="fu">cat</span>(<span class="st">"--&gt; SUGERENCIA: Intenta AUMENTAR el valor de 'alpha_threshold_occ' (e.g., a 0.10 o 0.15) y vuelve a ejecutar.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"No se pudo crear el grafo de ocupaciones o no tiene enlaces para extraer el backbone.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Extrayendo Backbone de Ocupaciones (Disparity Filter, alpha = 0.1)...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
* Backbone Ocupaciones (Disparity α=0.10): 458 nodos, 5 enlaces significativos (0.00% del original).

Calculando Centralidad (No Ponderada) en Backbone de Ocupaciones y Filtrando Nodos Aislados...

#### Top 20 Ocupaciones por Grado (Backbone, Solo Conectados)


| Rank|Nombre                                                  |Valor |
|----:|:-------------------------------------------------------|:-----|
|    1|Farmworkers and Laborers, Crop, Nursery, and Greenhouse |2e+00 |
|    2|Industrial Machinery Mechanics                          |2e+00 |
|    3|Fishing and Hunting Workers                             |1e+00 |
|    4|Plumbers, Pipefitters, and Steamfitters                 |1e+00 |
|    5|Maintenance Workers, Machinery                          |1e+00 |
|    6|Maintenance and Repair Workers, General                 |1e+00 |
|    7|Helpers--Installation, Maintenance, and Repair Workers  |1e+00 |
|    8|Ship Engineers                                          |1e+00 |


#### Top 20 Ocupaciones por Intermediación (Backbone, Solo Conectados)


| Rank|Nombre                                                  |Valor   |
|----:|:-------------------------------------------------------|:-------|
|    1|Farmworkers and Laborers, Crop, Nursery, and Greenhouse |9.6e-06 |
|    2|Industrial Machinery Mechanics                          |9.6e-06 |
|    3|Fishing and Hunting Workers                             |0.0e+00 |
|    4|Plumbers, Pipefitters, and Steamfitters                 |0.0e+00 |
|    5|Maintenance Workers, Machinery                          |0.0e+00 |
|    6|Maintenance and Repair Workers, General                 |0.0e+00 |
|    7|Helpers--Installation, Maintenance, and Repair Workers  |0.0e+00 |
|    8|Ship Engineers                                          |0.0e+00 |


(No se pudo calcular Vector Propio para Ocupaciones en Backbone)</code></pre>
</div>
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--------------------------------------------------</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
--------------------------------------------------</code></pre>
</div>
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"(Nota Final: El backbone con Filtro de Disparidad ('disparity') extrae los enlaces cuyos pesos son estadísticamente altos comparados con otros enlaces del mismo nodo. Las tablas de centralidad anteriores muestran solo los nodos que permanecen conectados *dentro* de esta estructura significativa.)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Nota Final: El backbone con Filtro de Disparidad ('disparity') extrae los enlaces cuyos pesos son estadísticamente altos comparados con otros enlaces del mismo nodo. Las tablas de centralidad anteriores muestran solo los nodos que permanecen conectados *dentro* de esta estructura significativa.)</code></pre>
</div>
<details class="code-fold">
<summary>Mostrar/Ocultar Código</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"--------------------------------------------------</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------------</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>